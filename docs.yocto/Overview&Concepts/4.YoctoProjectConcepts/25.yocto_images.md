# Yocto Project 이미지 (Images)

Yocto Project에서 **이미지(Images)**는 빌드 프로세스의 최종 결과물로, 타겟 디바이스에 플래싱하거나 부팅하여 사용할 수 있는 루트 파일시스템 및 관련 바이너리들을 의미합니다.

## 1. 개요

이미지는 커널, 부트로더, 그리고 수많은 소프트웨어 패키지들이 설치된 루트 파일시스템(`rootfs`)을 포함하는 바이너리 파일입니다. BitBake는 이미지 레시피에 정의된 내용을 바탕으로 이 이미지를 생성합니다.

## 2. 이미지 생성 과정

이미지 생성은 주로 `do_rootfs` 태스크에 의해 수행됩니다.

1.  **패키지 설치:** `IMAGE_INSTALL` 변수에 정의된 패키지 목록을 확인합니다.
2.  **패키지 피드 참조:** `tmp/deploy/` 디렉토리의 패키지 피드(RPM, DEB, IPK)에서 해당 패키지들을 가져옵니다.
3.  **루트 파일시스템 구성:** 임시 디렉토리에 패키지들을 설치하여 실제 파일시스템 구조를 만듭니다.
4.  **후처리 (Post-processing):** 사용자 계정 생성, 설정 파일 수정, 라이선스 매니페스트 생성 등의 작업을 수행합니다.
5.  **압축 및 포맷팅:** 구성된 파일시스템을 `IMAGE_FSTYPES`에 정의된 형식(ext4, wic, tar 등)으로 변환합니다.

## 3. 이미지 레시피 (Image Recipes)

이미지는 일반적인 소프트웨어 패키지와 마찬가지로 레시피(`.bb`) 파일로 정의됩니다.

*   **위치:** 보통 `recipes-core/images/` 또는 `recipes-<layer>/images/`에 위치합니다.
*   **예시:**
    *   `core-image-minimal`: 부팅 가능한 가장 작은 크기의 이미지.
    *   `core-image-sato`: X11 기반의 모바일 스타일 GUI를 포함한 이미지.
    *   `core-image-full-cmdline`: CLI 도구들을 포함한 이미지.

## 4. 이미지 커스터마이징

이미지를 커스터마이징하는 방법은 크게 두 가지가 있습니다.

### 4.1 local.conf 수정
간단한 패키지 추가나 기능 활성화는 `conf/local.conf`에서 수행할 수 있습니다.

```bitbake
# 패키지 추가
IMAGE_INSTALL:append = " strace htop"

# 기능 추가 (디버깅, 패키지 관리 등)
EXTRA_IMAGE_FEATURES += "debug-tweaks package-management"
```

### 4.2 커스텀 이미지 레시피 작성
기존 이미지를 기반으로 새로운 레시피를 작성할 수 있습니다.

```bitbake
# my-image.bb
require recipes-core/images/core-image-minimal.bb

IMAGE_INSTALL += "my-app python3"
```

## 5. 이미지 형식 (IMAGE_FSTYPES)

생성될 이미지 파일의 형식은 `IMAGE_FSTYPES` 변수로 제어합니다.

*   **`tar.bz2` / `tar.gz`**: 루트 파일시스템을 압축한 아카이브. (NFS 부팅이나 수동 설치 시 유용)
*   **`ext4`**: 리눅스 표준 파일시스템 이미지.
*   **`wic`**: 파티션 테이블, 부트로더, 커널, 루트 파일시스템을 모두 포함하는 디스크 이미지. (SD 카드 등에 바로 쓸 수 있음)
*   **`cpio.gz`**: initramfs용 이미지.

## 6. 요약

Yocto Project의 이미지는 단순한 파일 묶음이 아니라, 배포판 정책과 하드웨어 설정이 결합된 완전한 운영체제 스냅샷입니다.
