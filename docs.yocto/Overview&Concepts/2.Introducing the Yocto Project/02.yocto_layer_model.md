# Yocto Project 레이어 모델 (The Yocto Project Layer Model)

Yocto Project의 가장 강력하고 핵심적인 특징 중 하나는 **레이어(Layer)** 모델입니다. 레이어는 관련된 메타데이터(레시피, 설정 파일, 클래스 등)를 논리적으로 그룹화한 집합입니다.

## 1. 개요

레이어 모델은 시스템의 구성 요소들을 모듈화하여 관리할 수 있게 해줍니다. 이를 통해 하드웨어 지원, 배포판 정책, 소프트웨어 패키지 등을 서로 분리하여 독립적으로 유지 관리하고 재사용할 수 있습니다.

*   **관례:** 레이어 이름은 보통 `meta-`로 시작합니다 (예: `meta-raspberrypi`, `meta-qt5`).
*   **구조:** 각 레이어는 최상위에 `conf/layer.conf` 파일을 포함하여 BitBake가 해당 레이어를 인식하고 처리하는 방법을 정의합니다.

## 2. 레이어 모델의 장점

1.  **모듈성 (Modularity):** 특정 기능을 별도의 레이어로 분리하여 필요에 따라 추가하거나 제거할 수 있습니다.
2.  **재사용성 (Reusability):** 하드웨어 지원 레이어(BSP)를 변경하지 않고도 상위 애플리케이션 레이어를 다른 하드웨어 프로젝트에 재사용할 수 있습니다.
3.  **격리 (Isolation):** 핵심 빌드 시스템(OE-Core)을 수정하지 않고도, 자신의 레이어에서 `bbappend` 등을 통해 기존 레시피의 동작을 변경하거나 확장할 수 있습니다. 이는 Yocto Project 업그레이드 시 유지 보수를 용이하게 합니다.

## 3. 레이어의 종류

일반적으로 레이어는 그 역할에 따라 다음과 같이 분류됩니다.

### 3.1 OpenEmbedded-Core (OE-Core)
*   **설명:** 가장 기본이 되는 레이어로, `meta` 디렉토리에 위치합니다.
*   **역할:** 빌드 시스템의 핵심 클래스, 기본 레시피(glibc, gcc, busybox 등), 공통 설정 등을 포함합니다. 모든 Yocto 빌드의 기반이 됩니다.

### 3.2 BSP 레이어 (Board Support Package)
*   **설명:** 특정 하드웨어 플랫폼을 지원하기 위한 레이어입니다.
*   **역할:** 커널 설정, 부트로더, 하드웨어 드라이버, 머신 설정 파일(`conf/machine/*.conf`) 등을 포함합니다.
*   **예시:** `meta-raspberrypi`, `meta-intel`, `meta-ti`.

### 3.3 배포판 레이어 (Distro Layer)
*   **설명:** 배포판의 정책(Policy)을 정의하는 레이어입니다.
*   **역할:** 초기화 시스템(SysVinit vs systemd), 툴체인 설정, 기본 설치 패키지 목록 등 시스템 전반의 정책을 결정합니다.
*   **예시:** `meta-poky`.

### 3.4 소프트웨어 레이어 (Software Layer)
*   **설명:** 특정 소프트웨어 스택이나 애플리케이션 그룹을 제공하는 레이어입니다.
*   **역할:** 웹 서버, GUI 프레임워크, 보안 도구 등 특정 도메인의 패키지들을 묶어서 제공합니다.
*   **예시:** `meta-qt5` (Qt 프레임워크), `meta-python` (파이썬 모듈), `meta-security`.

## 4. 레이어 관리

### 4.1 bblayers.conf
빌드 프로젝트의 `conf/bblayers.conf` 파일은 현재 빌드에 포함될 레이어들의 경로 목록(`BBLAYERS`)을 정의합니다. BitBake는 이 목록에 있는 레이어들만 파싱합니다.

### 4.2 레이어 우선순위 (Layer Priority)
각 레이어의 `conf/layer.conf` 파일에는 `BBFILE_PRIORITY` 변수가 설정되어 있습니다.
*   동일한 이름의 레시피가 여러 레이어에 존재할 경우, 우선순위가 높은 레이어의 레시피가 사용됩니다.
*   일반적으로 구체적인 레이어(예: 커스텀 레이어)가 일반적인 레이어(예: OE-Core)보다 높은 우선순위를 가집니다.

## 5. 요약

Yocto Project의 레이어 모델은 **"설정(Configuration)과 정책(Policy)을 하드웨어(Hardware) 및 소프트웨어(Software)와 분리"**하는 것을 목표로 합니다. 이를 통해 개발자는 복잡한 임베디드 리눅스 시스템을 체계적이고 효율적으로 구축할 수 있습니다.
