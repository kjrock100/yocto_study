# Yocto Project OpenEmbedded 빌드 시스템 워크플로우 (The OpenEmbedded Build System Workflow)

OpenEmbedded 빌드 시스템의 워크플로우는 소스 코드, 설정, 메타데이터를 입력받아 최종적으로 부팅 가능한 이미지나 SDK를 생성하는 일련의 과정입니다.

## 1. 개요

이 과정은 **BitBake**에 의해 관리되며, 크게 설정, 파싱, 실행(Fetch -> Build -> Package -> Image) 단계로 나눌 수 있습니다.

## 2. 상세 단계

### 2.1 설정 및 파싱 (Configuration & Parsing)
빌드가 시작되면 BitBake는 다음 순서로 설정을 읽어들입니다.
1.  **설정 파일 (`.conf`):** `bblayers.conf`, `local.conf`, `machine.conf`, `distro.conf` 등을 읽어 전역 변수와 환경을 설정합니다.
2.  **클래스 (`.bbclass`):** 공통 로직을 정의한 클래스 파일들을 로드합니다.
3.  **레시피 (`.bb`):** 레이어에 포함된 레시피들을 파싱하여 의존성 그래프를 생성합니다.

### 2.2 소스 가져오기 (Source Fetching)
각 레시피에 정의된 `SRC_URI`를 통해 소스 코드를 가져옵니다.
*   **Fetch:** 업스트림 저장소(Git, Tarball 등)에서 소스를 다운로드하여 `DL_DIR`에 저장합니다.
*   **Unpack:** 다운로드한 소스를 작업 디렉토리(`WORKDIR`)에 압축 해제합니다.

### 2.3 패치 적용 (Patching)
소스 코드에 Yocto Project 특화 패치나 버그 수정을 적용합니다.
*   레시피에 정의된 `.patch` 파일들을 소스 트리에 적용합니다.

### 2.4 구성 및 컴파일 (Configuration, Compilation, and Staging)
소프트웨어를 빌드합니다.
*   **Configure:** `configure` 스크립트나 `cmake` 등을 실행하여 빌드 환경을 구성합니다.
*   **Compile:** 소스 코드를 컴파일하여 바이너리를 생성합니다.
*   **Install:** 생성된 파일을 임시 목적지(`D`)에 설치합니다.
*   **Sysroot Population:** 다른 레시피가 참조할 수 있도록 라이브러리와 헤더를 Sysroot(`STAGING_DIR`)에 복사합니다.

### 2.5 패키지 분할 (Package Splitting)
설치된 파일들을 패키지 관리자 형식(RPM, DEB, IPK)에 맞춰 분할합니다.
*   예: `openssl` -> `openssl-bin`, `openssl-dev`, `openssl-dbg` 등으로 나뉩니다.
*   이 단계에서 QA 체크(라이선스, 경로 등)가 수행됩니다.

### 2.6 이미지 생성 (Image Generation)
최종 루트 파일시스템을 생성합니다.
*   `IMAGE_INSTALL`에 정의된 패키지들을 패키지 피드에서 가져와 설치합니다.
*   후처리(Post-processing)를 통해 사용자 계정 생성, 설정 파일 수정 등을 수행합니다.
*   최종적으로 파일시스템 이미지(ext4, wic 등)를 압축하여 생성합니다.

## 3. 요약

워크플로우는 **"입력(소스, 메타데이터) -> BitBake 엔진 -> 출력(이미지, SDK, 패키지)"**의 흐름을 따릅니다. 이 모든 과정은 자동화되어 있으며, 공유 상태 캐시(SState Cache)를 통해 반복 빌드 속도를 획기적으로 높입니다.
