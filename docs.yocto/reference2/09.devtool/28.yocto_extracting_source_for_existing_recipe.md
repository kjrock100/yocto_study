# Yocto Project 기존 레시피의 소스 추출 (Extracting the Source for an Existing Recipe)

Yocto Project에서 기존 레시피의 소스 코드를 수정하거나 분석하기 위해 `devtool modify` 명령어를 사용하여 소스를 추출하는 방법에 대해 설명합니다.

## 1. 개요

`devtool modify` 명령은 기존 레시피의 소스 코드를 워크스페이스(`build/workspace/sources`)로 가져와서, 개발자가 자유롭게 수정하고 빌드할 수 있는 환경을 구성합니다. 이 명령을 실행하면 빌드 시스템은 해당 레시피를 빌드할 때 다운로드된 압축 파일이나 원격 저장소 대신, 워크스페이스에 추출된 로컬 소스 코드를 사용하게 됩니다.

## 2. 기본 사용법

```bash
devtool modify [options] <recipe> [srctree]
```

*   **`<recipe>`**: 수정할 레시피의 이름입니다 (예: `bash`, `linux-yocto`).
*   **`[srctree]`**: 소스 코드가 추출될 로컬 경로입니다. 지정하지 않으면 기본적으로 `build/workspace/sources/<recipe>` 디렉토리가 사용됩니다.

## 3. 주요 옵션

*   **`--no-extract` (`-n`)**: 소스 코드를 추출하지 않습니다. 이미 소스 코드가 로컬에 준비되어 있고, 레시피가 그 위치를 참조하도록 설정만 하고 싶을 때 유용합니다.
*   **`--same-dir` (`-s`)**: 소스 트리를 별도의 하위 디렉토리가 아닌 지정된 디렉토리에 바로 구축합니다.
*   **`--branch` (`-b`)**: Git 소스인 경우 특정 브랜치를 체크아웃합니다.

## 4. 실행 예시

### 4.1 기본 추출
`bash` 패키지의 소스를 수정하고 싶다면 다음과 같이 실행합니다.

```bash
devtool modify bash
```
이 명령은 `bash`의 소스 코드를 `build/workspace/sources/bash`에 추출하고, 워크스페이스 레이어 설정을 업데이트합니다.

### 4.2 특정 디렉토리에 추출
커널 소스를 내 홈 디렉토리의 `my-kernel` 폴더에 추출하고 싶다면 다음과 같이 실행합니다.

```bash
devtool modify linux-yocto /home/user/my-kernel
```

## 5. 작동 원리

명령이 실행되면 다음과 같은 작업이 수행됩니다.

1.  **소스 준비:** 레시피에 정의된 `SRC_URI`에서 소스를 가져와 지정된 디렉토리에 압축을 풀거나 체크아웃합니다. 패치(`patches`)가 있다면 적용됩니다.
2.  **Git 초기화:** 추출된 소스 디렉토리에 Git 저장소를 초기화합니다. 이를 통해 변경 사항을 커밋으로 관리할 수 있습니다.
3.  **bbappend 생성:** `build/workspace/appends/` 디렉토리에 해당 레시피에 대한 `.bbappend` 파일을 생성합니다. 이 파일은 `EXTERNALSRC` 클래스를 사용하여 빌드 시스템이 추출된 로컬 소스를 바라보도록 설정합니다.

## 6. 이후 작업

소스 추출이 완료되면 다음 작업을 수행할 수 있습니다.

1.  **소스 수정:** 추출된 디렉토리로 이동하여 코드를 수정합니다.
2.  **빌드:** `devtool build <recipe>` 명령으로 수정 사항을 빌드합니다.
3.  **배포:** `devtool deploy-target <recipe> <target>` 명령으로 타겟 장비에 배포하여 테스트합니다.

---
*참고: 작업을 마치고 변경 사항을 레이어에 적용하거나 취소하려면 `devtool finish` 또는 `devtool reset` 명령을 사용해야 합니다.*
