# Yocto Project 구성 조각 (Configuration Fragments)

Yocto Project에서 **Configuration Fragments(설정 조각)**는 전체 설정 파일을 복사하거나 직접 수정하는 대신, 특정 기능이나 설정을 활성화/비활성화하기 위한 설정의 일부(조각)를 의미합니다. 이를 통해 설정을 모듈화하고 재사용성을 높일 수 있습니다.

## 1. 개요

설정 조각은 **베이스 설정(Base Configuration)**에 **변경 사항(Delta)**만을 적용하는 방식으로 작동합니다. 이는 유지보수를 용이하게 하고, 다양한 요구사항에 맞춰 설정을 유연하게 조합할 수 있게 해줍니다.

크게 **빌드 설정 조각**과 **커널 설정 조각**으로 나눌 수 있습니다.

## 2. 빌드 설정 조각 (Build Configuration Fragments)

빌드 환경(`local.conf` 등)을 제어하기 위한 조각들입니다. 최신 Yocto Project에서는 `bitbake-config-build` 도구를 통해 이를 관리할 수 있습니다.

### `bitbake-config-build` 도구
이 도구를 사용하면 미리 정의된 설정 조각을 빌드 환경에 쉽게 적용할 수 있습니다.

*   **`list-fragments`**: 사용 가능한 설정 조각 목록을 표시합니다.
*   **`show-fragment`**: 특정 조각의 내용을 확인합니다.
*   **`enable-fragment`**: 특정 조각을 활성화하여 빌드 설정에 적용합니다.
*   **`disable-fragment`**: 특정 조각을 비활성화합니다.

### 예시
*   `core/yocto/sstate-mirror-cdn`: SState 미러를 CDN으로 설정하여 빌드 속도를 높입니다.
*   `core/yocto/root-login-with-empty-password`: 루트 사용자가 비밀번호 없이 로그인할 수 있도록 설정합니다 (개발용).

## 3. 커널 설정 조각 (Kernel Configuration Fragments)

리눅스 커널 빌드 시 `.config` 파일을 관리하는 가장 일반적인 방법입니다.

### 특징
*   **파일 형식:** 주로 `.cfg` 확장자를 사용하며, 표준 커널 설정 문법을 따릅니다.
    ```ini
    CONFIG_USB_SUPPORT=y
    CONFIG_USB_XHCI_HCD=y
    # CONFIG_USB_EHCI_HCD is not set
    ```

### 사용 방법
레시피 파일의 `SRC_URI` 변수에 `.cfg` 파일을 추가하면, `kernel-yocto` 클래스가 이를 감지하여 베이스 설정(`defconfig`)에 병합합니다.

### 생성 방법 (`do_diffconfig`)
1.  `bitbake -c menuconfig virtual/kernel`을 실행하여 커널 설정을 변경하고 저장합니다.
2.  `bitbake -c diffconfig virtual/kernel`을 실행합니다.
3.  빌드 디렉토리에 생성된 `fragment.cfg` 파일을 찾아 레이어에 복사하여 사용합니다.

---
*참고: 이 문서는 Yocto Project 참조 매뉴얼의 Configuration Fragments 섹션을 기반으로 작성되었습니다.*
