# Yocto Project 이미지 (Images)

Yocto Project에서 **이미지(Image)**는 타겟 장치에서 실행되는 운영 체제의 최종 결과물입니다. 이미지 레시피에 의해 정의되며, 루트 파일시스템(Root Filesystem)을 구성하는 패키지들의 집합과 커널, 부트로더 등을 포함합니다.

## 1. 개요

이미지는 Yocto 빌드 시스템(BitBake)이 생성하는 최상위 레벨의 아티팩트입니다. 이미지 레시피(`.bb`)는 어떤 패키지들이 설치되어야 하는지(`IMAGE_INSTALL`), 어떤 기능들이 활성화되어야 하는지(`IMAGE_FEATURES`), 그리고 파일시스템이 어떤 포맷으로 생성되어야 하는지(`IMAGE_FSTYPES`) 등을 정의합니다.

## 2. 표준 이미지 (Standard Images)

Yocto Project의 레퍼런스 배포판인 Poky는 다양한 기본 이미지를 제공합니다.

*   **`core-image-minimal`**: 부팅 가능한 가장 작은 규모의 이미지입니다. 하드웨어 부팅 테스트에 유용합니다.
*   **`core-image-base`**: 콘솔 전용 이미지로, 타겟 하드웨어의 표준 기능을 완벽하게 지원합니다.
*   **`core-image-sato`**: 모바일 장치를 위한 X11 기반의 Sato 데스크탑 환경을 포함한 이미지입니다.
*   **`core-image-weston`**: Wayland 및 Weston 레퍼런스 컴포지터를 포함한 그래픽 이미지입니다.
*   **`core-image-full-cmdline`**: CLI(Command Line Interface) 경험을 위한 풀 기능을 갖춘 콘솔 이미지입니다.

## 3. 이미지 구조 및 설정

이미지 레시피는 일반적으로 `core-image` 클래스를 상속받아 작성됩니다.

### 3.1 주요 변수

*   **`IMAGE_INSTALL`**: 이미지에 설치할 패키지 목록을 정의합니다.
    ```bitbake
    IMAGE_INSTALL += "strace gdb"
    ```
*   **`IMAGE_FEATURES`**: 패키지 그룹을 쉽게 추가하기 위한 기능 목록입니다.
    *   `ssh-server-openssh`: OpenSSH 서버 설치.
    *   `debug-tweaks`: 루트 비밀번호 없음 등 디버깅 편의 기능 활성화.
    *   `tools-debug`: gdb, strace 등 디버깅 도구 포함.
    *   `package-management`: 타겟에서 dnf, opkg 등을 사용해 패키지 관리 가능.
*   **`IMAGE_FSTYPES`**: 생성할 이미지 파일의 포맷을 지정합니다 (예: `tar.bz2`, `ext4`, `wic`, `cpio.gz`).

## 4. 이미지 커스터마이징

이미지를 커스터마이징하는 방법은 크게 두 가지가 있습니다.

1.  **`local.conf` 수정:** 기존 이미지를 빌드하되 추가 패키지를 넣고 싶은 경우.
    ```bitbake
    # build/conf/local.conf
    IMAGE_INSTALL:append = " vim git"
    ```
2.  **커스텀 이미지 레시피 작성:** 자신만의 이미지를 정의하는 경우.
    ```bitbake
    # meta-mylayer/recipes-core/images/my-image.bb
    SUMMARY = "My Custom Image"
    LICENSE = "MIT"
    inherit core-image
    IMAGE_INSTALL += "my-app python3"
    ```

## 5. 빌드 및 출력

이미지를 빌드하려면 `bitbake` 명령어를 사용합니다.

```bash
bitbake core-image-minimal
```

빌드가 완료되면 결과물은 다음 경로에 저장됩니다.

*   `build/tmp/deploy/images/<machine>/`

---
*참고: 이미지는 단순히 패키지들의 모음이 아니라, `rootfs` 생성 과정에서 사용자 계정 설정, 초기화 스크립트 설정 등 후처리 작업(Post-processing)도 수행합니다.*
