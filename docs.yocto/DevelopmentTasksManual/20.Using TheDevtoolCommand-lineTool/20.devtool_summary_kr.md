# Yocto Project devtool 사용 가이드 (Using the devtool command-line tool)

`devtool`은 Yocto Project의 강력한 개발 도구로, 개발자가 레시피를 쉽게 생성, 수정, 테스트 및 업그레이드할 수 있도록 돕습니다. 이 도구는 `workspace`라는 별도의 레이어를 사용하여 기존 빌드 환경(메타데이터)을 건드리지 않고 작업을 수행할 수 있게 합니다.

## 1. devtool add: 새 애플리케이션 추가

새로운 소프트웨어를 Yocto 빌드 시스템에 추가할 때 사용합니다.

* **기능**: 소스 코드(로컬 경로, 원격 Git URL, Tarball 등)를 지정하면 `devtool`이 자동으로 기본 레시피를 생성하고 작업 공간에 소스를 준비합니다.
* **사용법**: `devtool add <recipe-name> <source-url>`
  * 예: `devtool add my-application https://github.com/example/my-app.git`
* **주요 특징**:
  * **자동 감지**: 소스의 이름, 버전, 빌드 시스템(Autotools, CMake, Make, Node.js 등)을 자동으로 파악하여 레시피를 구성합니다.
  * **의존성 매핑**: 빌드에 필요한 의존성을 감지하여 `DEPENDS` 변수에 추가하려고 시도합니다.
  * **라이선스 감지**: 소스 내의 라이선스 파일(COPYING, LICENSE 등)을 찾아 `LIC_FILES_CHKSUM`을 생성합니다.

## 2. devtool modify: 기존 레시피 수정

이미 존재하는 레시피의 소스 코드를 수정하거나 패치를 작업할 때 사용합니다.

* **기능**: 해당 레시피의 소스 코드를 추출하여 작업 공간(`workspace/sources/<recipe>`)에 배치합니다. 개발자는 이 디렉토리에서 코드를 자유롭게 수정, 컴파일, 커밋할 수 있습니다.
* **사용법**: `devtool modify <recipe-name>`
  * 예: `devtool modify virtual/kernel` (리눅스 커널 수정 시)
* **활용**: 소스 코드가 로컬에 준비되므로 `git`을 사용하여 변경 사항을 관리하고 패치를 생성하기 용이합니다.

## 3. devtool ide-sdk: IDE 개발 환경 구성

수정 중인 컴포넌트를 VSCode 등의 IDE에서 효율적으로 개발하기 위해 SDK와 설정을 구성합니다.

* **기능**: `devtool`이 SDK를 준비하고, IDE용 프로젝트 설정 파일(예: `c_cpp_properties.json`, `launch.json`)을 생성합니다.
* **장점**: 크로스 컴파일 환경에서의 헤더 경로 인식, 코드 자동 완성, 원격 디버깅(GDB) 기능을 IDE 내에서 바로 사용할 수 있습니다.
* **사용법**: `devtool ide-sdk <recipe-name> <target-ide>`

## 4. devtool upgrade: 레시피 업그레이드

소프트웨어의 업스트림 버전이 변경되었을 때 레시피를 최신 버전으로 갱신합니다.

* **기능**: 소스를 최신 버전으로 업데이트하고, 레시피의 버전 및 체크섬(checksum)을 갱신합니다. 또한 기존에 적용된 패치들을 새로운 소스 코드에 다시 적용(Rebase)하려고 시도합니다.
* **사용법**: `devtool upgrade <recipe-name> -V <version>`
  * 예: `devtool upgrade -V 2.0.0 my-recipe`

## 5. 작업 공간에서의 개발 (Working With Recipes)

레시피가 작업 공간(`workspace`)에 추가되면 다음과 같은 작업을 수행할 수 있습니다.

* **빌드 (Build)**: `devtool build <recipe>` 명령으로 변경 사항을 즉시 빌드합니다.
* **설정 변경 (Configure)**: `devtool configure-help`로 옵션을 확인하고 `devtool configure`로 `do_configure` 단계의 인자를 변경할 수 있습니다.
* **패키징 확인**: `devtool package <recipe>`를 실행하여 패키지 생성 결과물(ipk, rpm, deb 등)을 확인할 수 있습니다.
* **로그 확인**: 빌드 실패 시 `temp` 디렉토리의 로그 파일(`log.do_configure`, `log.do_compile`)을 분석합니다.

## 6. 타겟 장치 배포 및 테스트

개발 중인 애플리케이션을 실제 타겟 하드웨어(또는 QEMU)에서 테스트할 수 있습니다.

* **배포 (Deploy)**: `devtool deploy-target <recipe> <target-ip>`
  * 빌드된 결과물을 SSH를 통해 타겟 장치에 직접 설치합니다. 이미지를 다시 굽지 않고도 빠른 테스트가 가능합니다.
* **복원 (Undeploy)**: `devtool undeploy-target <recipe> <target-ip>`
  * 테스트가 끝나면 배포된 파일을 제거하고 장치를 원래 상태로 되돌립니다.

## 7. 작업 완료 (Finish) 및 초기화 (Reset)

개발 및 테스트가 완료되면 변경 사항을 처리합니다.

* **devtool finish**: 작업 공간의 변경 사항을 실제 레이어(예: `meta-mylayer`)에 영구적으로 적용합니다.
  * 소스 수정 사항은 `.patch` 파일로 생성되어 레시피에 추가됩니다.
  * 사용법: `devtool finish <recipe> <destination-layer>`
* **devtool reset**: 작업을 취소하고 레시피를 작업 공간에서 제거합니다. 원래 레이어의 상태로 돌아갑니다.
  * 사용법: `devtool reset <recipe>`

---
*참고: 이 문서는 Yocto Project Development Tasks Manual의 내용을 바탕으로 작성되었습니다.*
