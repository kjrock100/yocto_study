# 외부 툴체인 선택적 사용 (Optionally Using an External Toolchain)

기본적으로 Yocto Project 빌드 시스템(BitBake)은 소스 코드로부터 크로스 컴파일 툴체인을 직접 빌드하여 사용합니다. 하지만 경우에 따라 이미 빌드된 외부 툴체인(External Toolchain)을 사용하고 싶을 수 있습니다.

## 1. 외부 툴체인을 사용하는 이유

* **빌드 시간 단축**: 툴체인을 처음부터 빌드하는 과정(gcc, glibc, binutils 등)을 생략할 수 있어 초기 빌드 시간이 크게 단축됩니다.
* **검증된 툴체인 사용**: 칩 벤더나 서드파티(Mentor Graphics, Linaro, ARM 등)에서 제공하는 최적화되고 검증된 툴체인을 사용할 수 있습니다.
* **표준화**: 조직 내에서 표준화된 특정 버전의 컴파일러를 강제해야 할 때 유용합니다.

## 2. 설정 방법

외부 툴체인을 사용하려면 `conf/local.conf` 파일에서 `TCMODE` 변수와 툴체인 경로를 설정해야 합니다. 또한, 해당 툴체인을 지원하는 메타데이터 레이어가 필요할 수 있습니다.

### 2.1 TCMODE 설정

`TCMODE` 변수는 사용할 툴체인의 모드를 지정합니다. 기본값은 `default` (Yocto 내부 빌드)입니다. 외부 툴체인을 위한 레이어를 추가한 후 해당 모드로 변경합니다.

```bash
TCMODE = "external-arm"
```

### 2.2 툴체인 경로 설정

`EXTERNAL_TOOLCHAIN` 변수에 외부 툴체인이 설치된 경로를 지정합니다.

```bash
EXTERNAL_TOOLCHAIN = "/opt/arm/gcc-arm-10.2-2020.11-x86_64-aarch64-none-linux-gnu"
```

### 2.3 필요한 레이어 추가

대부분의 상용 또는 오픈소스 외부 툴체인은 이를 Yocto Project와 연동하기 위한 별도의 레이어를 제공합니다. 예를 들어 `meta-arm-toolchain`, `meta-linaro`, `meta-sourcery` 등이 있습니다. 이 레이어들은 `TCMODE`에 대한 정의와 툴체인 레시피를 포함하고 있습니다.

## 3. 주의 사항

* **C 라이브러리 호환성**: 외부 툴체인에 포함된 glibc(또는 musl) 버전과 Yocto Project의 다른 패키지들이 기대하는 버전이 다를 경우 런타임 문제가 발생할 수 있습니다.
* **튜닝 옵션**: 외부 툴체인이 빌드될 때 사용된 아키텍처 튜닝 옵션과 Yocto 설정(`TUNE_FEATURES`)이 호환되는지 확인해야 합니다.
* **패키징**: 외부 툴체인의 라이브러리(libc, libgcc 등)를 타겟 이미지에 포함시키기 위해, Yocto 빌드 시스템은 외부 툴체인 디렉토리에서 라이브러리 파일을 복사하여 패키징합니다. 이 과정이 올바르게 수행되려면 레이어 설정이 정확해야 합니다.

---
*참고: 이 문서는 Yocto Project Development Tasks Manual의 'Optionally Using an External Toolchain' 섹션을 기반으로 작성되었습니다.*
