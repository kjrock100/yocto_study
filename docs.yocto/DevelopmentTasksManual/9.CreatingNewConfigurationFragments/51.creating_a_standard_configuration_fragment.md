# Yocto Project: 표준 구성 조각 생성 (Creating A Standard Configuration Fragment)

이 문서는 Yocto Project Development Tasks Manual의 9.1절을 기반으로, 리눅스 커널 구성을 변경하기 위해 표준 구성 조각(Configuration Fragment)을 작성하고 적용하는 방법을 설명합니다.

## 9.1 개요 (Overview)
구성 조각(Configuration Fragment)은 전체 커널 구성 파일(`defconfig`)을 대체하지 않고, 특정 옵션만 변경하거나 추가할 때 사용하는 작은 텍스트 파일입니다. 이를 통해 베이스라인 구성을 유지하면서 필요한 기능만 모듈식으로 관리할 수 있습니다. 일반적으로 `.cfg` 확장자를 사용합니다.

## 9.1.1 구성 조각 작성 (Creating the Fragment)
변경하려는 커널 구성 옵션(Kconfig)을 파일에 작성합니다.

* **파일 형식**:
    * 활성화 (Built-in): `CONFIG_OPTION=y`
    * 모듈로 빌드: `CONFIG_OPTION=m`
    * 비활성화: `# CONFIG_OPTION is not set`
    * 값 설정: `CONFIG_OPTION=value`

* **예시 (`my-serial.cfg`)**:
    ```text
    CONFIG_USB_SERIAL=y
    CONFIG_USB_SERIAL_PL2303=m
    # CONFIG_WIFI is not set
    ```

## 9.1.2 레시피에 적용 (Applying to the Recipe)
작성한 `.cfg` 파일을 커널 레시피 또는 `.bbappend` 파일의 `SRC_URI` 변수에 추가합니다.

* **위치**: `.cfg` 파일은 레시피가 찾을 수 있는 경로(예: `files/` 디렉토리)에 저장해야 합니다.
* **설정**:
    ```bitbake
    SRC_URI += "file://my-serial.cfg"
    ```

Yocto Project의 커널 빌드 시스템(`linux-yocto` 클래스 사용 시)은 `SRC_URI`에 포함된 `.cfg` 확장자 파일을 자동으로 감지하고, 커널 구성 단계(`do_configure`)에서 이를 기본 구성(`defconfig`)과 병합합니다.

## 9.1.3 검증 (Verification)
빌드 후 생성된 커널 구성 파일(`.config`)을 확인하여 변경 사항이 올바르게 적용되었는지 검증할 수 있습니다.
* **경로**: `${B}/.config` (일반적으로 `${WORKDIR}/linux-<machine>-<version>/build/.config`)

---
참고: 구성 조각에 명시된 옵션이 하드웨어 의존성이나 다른 옵션과의 충돌로 인해 적용되지 않을 수 있습니다. 이 경우 커널 빌드 로그나 `do_kernel_configcheck` 태스크의 결과를 확인해야 합니다.
