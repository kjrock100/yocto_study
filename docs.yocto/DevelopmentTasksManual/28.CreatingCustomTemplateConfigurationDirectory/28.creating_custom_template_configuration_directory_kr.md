# 사용자 정의 템플릿 구성 디렉토리 만들기 (Creating a Custom Template Configuration Directory)

Yocto Project 빌드 환경을 초기화할 때(`oe-init-build-env` 실행), 기본적으로 `local.conf`와 `bblayers.conf` 파일이 생성됩니다. 팀 내에서 표준화된 설정을 공유하거나, 특정 하드웨어/프로젝트에 맞는 초기 설정을 제공하고 싶다면 "사용자 정의 템플릿 구성 디렉토리"를 만들 수 있습니다.

## 1. 개요

빌드 환경 초기화 스크립트는 템플릿 디렉토리에서 `.sample` 파일들을 찾아 빌드 디렉토리의 `conf/` 폴더로 복사합니다. 기본 템플릿은 보통 `poky/meta-poky/conf/templates/default`에 위치하지만, 이를 사용자가 만든 레이어 내의 설정으로 대체할 수 있습니다.

## 2. 템플릿 디렉토리 구조

사용자 정의 템플릿은 일반적으로 자신의 레이어 내에 위치시킵니다. 예를 들어 `meta-mylayer`라는 레이어가 있다면 다음과 같은 구조를 권장합니다.

```text
meta-mylayer/
└── conf/
    └── templates/
        └── myconfig/
            ├── bblayers.conf.sample
            ├── local.conf.sample
            └── conf-notes.txt
```

### 2.1 구성 파일 설명

* **local.conf.sample**: `conf/local.conf`의 템플릿입니다. 머신(`MACHINE`), 배포판(`DISTRO`), 패키지 관리 등 프로젝트의 기본 설정을 정의합니다.
* **bblayers.conf.sample**: `conf/bblayers.conf`의 템플릿입니다. 빌드에 필요한 레이어들의 경로를 정의합니다. `##OEROOT##`와 같은 플레이스홀더를 사용하여 Yocto 소스 트리의 루트 경로를 동적으로 참조할 수 있습니다.
* **conf-notes.txt**: 빌드 환경 설정이 완료된 후 터미널에 출력될 메시지를 담고 있습니다. 주로 빌드 가능한 이미지 목록이나 주의 사항을 적습니다.

## 3. 템플릿 생성 방법

1. **디렉토리 생성**: 레이어 내에 템플릿 디렉토리를 만듭니다 (예: `meta-mylayer/conf/templates/myconfig`).
2. **샘플 파일 복사 및 수정**: 기존 `poky`의 샘플 파일들을 복사해온 뒤, 프로젝트 요구사항에 맞게 수정합니다.
    * `local.conf.sample`에서 `MACHINE ??= "qemux86-64"` 부분을 원하는 타겟 머신으로 변경합니다.
    * `bblayers.conf.sample`에 `meta-mylayer` 등 필요한 레이어 경로를 추가합니다.

## 4. 사용자 정의 템플릿 사용하기

템플릿을 적용하는 방법은 크게 두 가지가 있습니다.

### 4.1 환경 변수 사용 (TEMPLATECONF)

빌드 환경을 초기화할 때 `TEMPLATECONF` 환경 변수에 템플릿 디렉토리의 경로를 지정합니다.

```bash
export TEMPLATECONF=meta-mylayer/conf/templates/myconfig
source oe-init-build-env build
```

### 4.2 .templateconf 파일 사용

소스 트리의 최상위 디렉토리(예: `poky/`)에 `.templateconf` 파일을 생성하고, 그 안에 템플릿 디렉토리의 상대 경로를 적어두면 `oe-init-build-env` 실행 시 자동으로 해당 템플릿을 사용합니다.

---
*참고: 이 문서는 Yocto Project Development Tasks Manual의 'Creating a Custom Template Configuration Directory' 섹션을 기반으로 작성되었습니다.*
