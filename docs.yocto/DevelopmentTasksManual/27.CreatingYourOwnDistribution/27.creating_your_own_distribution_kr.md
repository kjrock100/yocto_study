# 자신만의 배포판 만들기 (Creating Your Own Distribution)

Yocto Project를 사용할 때, 단순히 `local.conf`를 수정하여 이미지를 커스터마이징하는 것을 넘어, 프로젝트 전반에 걸친 정책과 설정을 정의하기 위해 자신만의 "배포판(Distribution)"을 만들어야 할 때가 있습니다.

## 1. 배포판(Distribution)이란?

배포판 설정은 빌드되는 이미지와 SDK에 적용될 최상위 수준의 정책을 정의합니다. 여기에는 다음과 같은 결정 사항들이 포함됩니다.

* **패키지 관리 시스템**: RPM, IPK, DEB 중 어떤 형식을 사용할 것인가?
* **초기화 시스템**: SysVinit을 사용할 것인가, systemd를 사용할 것인가?
* **C 라이브러리**: glibc를 사용할 것인가, musl을 사용할 것인가?
* **시스템 기능**: WiFi, Bluetooth, OpenGL 등 시스템 전반적으로 지원할 기능(`DISTRO_FEATURES`)은 무엇인가?
* **툴체인 설정**: 컴파일러 버전이나 보안 플래그 등.

## 2. 언제 배포판을 만들어야 하는가?

* 단일 제품이 아닌, 여러 제품군에 공통적으로 적용될 베이스 설정이 필요할 때.
* `local.conf` 파일이 너무 복잡해져서 설정 관리가 어려울 때.
* Poky(참조 배포판)의 기본 설정과 근본적으로 다른 정책(예: systemd 전용, 보안 강화 등)을 적용해야 할 때.

## 3. 배포판 생성 방법 (Creating Your Own Distribution)

가장 쉽고 권장되는 방법은 기존의 Poky 배포판 설정을 복사하여 수정하는 것입니다.

### 3.1 레이어 준비

배포판 설정 파일은 보통 별도의 레이어(예: `meta-mydistro`) 내의 `conf/distro/` 디렉토리에 위치합니다.

### 3.2 설정 파일 생성

`poky.conf`를 참조하여 새로운 설정 파일(예: `mydistro.conf`)을 만듭니다.

```bash
# conf/distro/mydistro.conf 예시

require conf/distro/poky.conf

DISTRO = "mydistro"
DISTRO_NAME = "My Custom Distribution"
DISTRO_VERSION = "1.0"

# systemd를 기본 초기화 매니저로 사용하도록 설정
DISTRO_FEATURES:append = " systemd"
VIRTUAL-RUNTIME_init_manager = "systemd"
DISTRO_FEATURES_BACKFILL_CONSIDERED = "sysvinit"
```

## 4. 배포판 적용하기

새로 만든 배포판을 사용하려면 빌드 디렉토리의 `conf/local.conf` 파일에서 `DISTRO` 변수를 수정해야 합니다.

```bash
DISTRO = "mydistro"
```

---
*참고: 이 문서는 Yocto Project Development Tasks Manual의 'Creating Your Own Distribution' 섹션을 기반으로 작성되었습니다.*
