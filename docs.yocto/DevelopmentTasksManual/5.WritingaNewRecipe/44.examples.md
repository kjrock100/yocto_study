# Yocto Project: 예제 (Examples)

이 문서는 Yocto Project Development Tasks Manual의 5.21절을 기반으로, 다양한 시나리오별 레시피 작성 예제를 설명합니다.

## 5.21 개요 (Overview)

이 절에서는 단일 소스 파일 컴파일부터 복잡한 빌드 시스템 사용, 패키지 분할, 외부 바이너리 패키징 등 실제 개발 환경에서 자주 접하게 되는 일반적인 레시피 작성 패턴을 다룹니다.

## 5.21.1 단일 .c 파일 패키지 빌드 (Building a Single .c File Package)

별도의 빌드 시스템(Makefile 등) 없이 단일 C 소스 파일(`helloworld.c`)만 있는 경우입니다.

* **핵심**: `do_compile`과 `do_install` 태스크를 직접 작성해야 합니다.
* **예시**:

    ```bitbake
    SRC_URI = "file://helloworld.c"

    S = "${WORKDIR}"

    do_compile() {
        ${CC} ${CFLAGS} ${LDFLAGS} helloworld.c -o helloworld
    }

    do_install() {
        install -d ${D}${bindir}
        install -m 0755 helloworld ${D}${bindir}
    }
    ```

## 5.21.2 Makefile 기반 패키지 빌드 (Building a Makefile-Based Package)

소스 코드에 `Makefile`이 포함된 경우입니다.

* **핵심**: `oe_runmake`를 사용하여 `make`를 호출합니다.
* **예시**:

    ```bitbake
    SRC_URI = "file://myapp-1.0.tar.gz"

    # Makefile에 변수 전달
    EXTRA_OEMAKE = "'CC=${CC}' 'CFLAGS=${CFLAGS}'"

    do_compile() {
        oe_runmake
    }

    do_install() {
        oe_runmake install DESTDIR=${D}
    }
    ```

## 5.21.3 Autotools 패키지 빌드 (Building an Autotooled Package)

GNU Autotools(`configure.ac`, `Makefile.am`)를 사용하는 프로젝트입니다.

* **핵심**: `autotools` 클래스를 상속받으면 대부분의 작업이 자동화됩니다.
* **예시**:

    ```bitbake
    inherit autotools

    SRC_URI = "http://example.com/myapp-1.0.tar.gz"

    # configure 스크립트에 옵션 전달
    EXTRA_OECONF = "--enable-feature"
    ```

## 5.21.4 Meson 패키지 빌드 (Building a Meson Package)

Meson 빌드 시스템을 사용하는 최신 프로젝트입니다.

* **핵심**: `meson` 클래스를 상속받습니다.
* **예시**:

    ```bitbake
    inherit meson

    SRC_URI = "git://github.com/example/myapp.git;protocol=https;branch=main"
    ```

## 5.21.5 애플리케이션을 여러 패키지로 분할 (Splitting an Application into Multiple Packages)

하나의 빌드 결과물을 여러 개의 패키지(예: 메인 앱, 플러그인, 설정 파일 등)로 나누어 설치하고 싶을 때 사용합니다.

* **핵심**: `PACKAGES` 변수에 새 패키지 이름을 추가하고, `FILES` 변수로 파일을 할당합니다.
* **예시**:

    ```bitbake
    PACKAGES =+ "${PN}-plugins"

    FILES:${PN}-plugins = "${libdir}/myapp/plugins/*.so"
    FILES:${PN} += "${bindir}/myapp"
    ```

## 5.21.6 외부에서 생성된 바이너리 패키징 (Packaging Externally Produced Binaries)

소스 코드가 아닌, 이미 컴파일된 바이너리 파일을 패키징하는 경우입니다.

* **핵심**: `bin_package` 클래스를 사용하거나, `do_install`에서 파일을 복사하고 `do_configure`, `do_compile`을 비활성화합니다. 또한, 이미 스트립(strip)된 바이너리라면 QA 검사를 건너뛰어야 할 수 있습니다.
* **예시**:

    ```bitbake
    SRC_URI = "file://binary-app-1.0.tar.gz"

    # 빌드 단계 생략
    do_configure[noexec] = "1"
    do_compile[noexec] = "1"

    do_install() {
        install -d ${D}${bindir}
        install -m 0755 ${S}/binary-app ${D}${bindir}
    }

    # 이미 strip된 경우 경고 무시
    INSANE_SKIP:${PN} += "already-stripped"
    ```

---
참고: 각 예제는 기본적인 뼈대이며, 실제 프로젝트에서는 라이선스, 의존성, 체크섬 등의 추가 설정이 필요합니다.
