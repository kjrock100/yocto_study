# Yocto Project: 소스 코드 가져오기 (Fetching Code)

이 문서는 Yocto Project Development Tasks Manual의 5.5절을 기반으로, 레시피 빌드 과정의 첫 단계인 소스 코드를 가져오는 방법(Fetching)에 대해 설명합니다.

## 5.5 개요 (Overview)

빌드 프로세스의 첫 번째 단계는 `do_fetch` 태스크입니다. BitBake는 레시피의 `SRC_URI` 변수에 정의된 위치에서 소스 코드를 찾아 다운로드하고, 이를 다운로드 디렉토리(`DL_DIR`)에 저장합니다.

## 5.5.1 SRC_URI 변수 (The SRC_URI Variable)

`SRC_URI` 변수는 소스 파일의 위치를 지정합니다. URL 스킴을 사용하여 다양한 프로토콜을 지원합니다.

* **구문**: `SRC_URI = "scheme://url;param=value"`
* **주요 스킴**:
  * `http://`, `https://`, `ftp://`: 원격 서버의 압축 파일(tarball) 등을 가져옵니다.
  * `git://`: Git 저장소에서 소스를 가져옵니다.
  * `file://`: 로컬 머신(레이어 내의 `files` 디렉토리 등)에 있는 파일을 가져옵니다. 패치나 설정 파일에 주로 사용됩니다.

* **예시**:

    ```bitbake
    SRC_URI = "https://example.com/downloads/app-1.0.tar.gz \
               file://fix-makefile.patch"
    ```

## 5.5.2 체크섬 검증 (Checksum Validation)

로컬 파일이나 SCM을 사용하지 않는 원격 소스(tarball 등)의 경우, 무결성을 보장하기 위해 체크섬을 명시해야 합니다.

* **변수**:
  * `SRC_URI[md5sum]`: MD5 체크섬
  * `SRC_URI[sha256sum]`: SHA-256 체크섬

* **예시**:

    ```bitbake
    SRC_URI[md5sum] = "a1b2c3d4e5f6..."
    SRC_URI[sha256sum] = "1234567890abcdef..."
    ```

## 5.5.3 SCM에서 가져오기 (Fetching from SCM)

Git과 같은 버전 관리 시스템을 사용할 때는 `SRCREV` 변수를 사용하여 특정 커밋 해시를 지정해야 합니다.

* **Git 예시**:

    ```bitbake
    SRC_URI = "git://github.com/example/project.git;protocol=https;branch=main"
    SRCREV = "abcdef1234567890..."
    ```

  * 최신 버전을 가져오려면 `SRCREV = "${AUTOREV}"`를 사용할 수 있지만, 재현 가능한 빌드를 위해 특정 해시를 명시하는 것이 권장됩니다.

## 5.5.4 방화벽을 통한 가져오기 (Fetching Code Through Firewalls)

방화벽 뒤에서 빌드하는 경우 프록시 설정이 필요할 수 있습니다. `.bashrc` 또는 `local.conf`에 `http_proxy`, `https_proxy` 등의 환경 변수를 설정하여 BitBake가 이를 사용하도록 합니다.

## 5.5.5 병렬 연결 제한 (Limiting the Number of Parallel Connections)

서버 부하를 줄이거나 네트워크 대역폭을 관리하기 위해 병렬 다운로드 수를 제한할 수 있습니다. 이는 주로 `BB_NUMBER_THREADS` 변수나 특정 Fetcher 옵션을 통해 관리됩니다.

---
참고: 다운로드된 파일은 `DL_DIR` 변수에 지정된 디렉토리에 캐시되므로, 동일한 소스를 다시 빌드할 때 네트워크 다운로드를 건너뛸 수 있습니다.
