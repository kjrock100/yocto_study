# Yocto Project: 컴파일 (Compilation)

이 문서는 Yocto Project Development Tasks Manual의 5.12절을 기반으로, 소스 코드를 컴파일하는 `do_compile` 태스크와 관련 설정을 설명합니다.

## 5.12 개요 (Overview)

`do_configure` 태스크가 완료되면 BitBake는 `do_compile` 태스크를 실행합니다. 이 단계에서는 구성된 소스 코드를 실제 바이너리나 객체 파일로 컴파일합니다.

## 5.12.1 do_compile 태스크 (The do_compile Task)

* **실행 위치**: 기본적으로 `B` 변수에 정의된 빌드 디렉토리에서 실행됩니다.
  * 소스 트리 내에서 빌드하는 경우 `B = "${S}"`입니다.
  * 별도의 빌드 디렉토리를 사용하는 경우(Out-of-tree build), `B`는 `S`와 다를 수 있습니다.

## 5.12.2 Makefile 기반 빌드 (Makefile-based Builds)

`make`를 사용하는 프로젝트의 경우, `do_compile` 태스크는 일반적으로 `oe_runmake` 함수를 호출합니다.

* **oe_runmake**:
  * BitBake가 제공하는 함수로, `make` 명령어에 적절한 병렬 빌드 옵션(`-j`)과 크로스 컴파일 환경 변수(`CC`, `LD` 등)를 자동으로 전달합니다.
  * `EXTRA_OEMAKE` 변수에 정의된 인자들도 함께 전달됩니다.

* **예시**:

    ```bitbake
    do_compile() {
        oe_runmake
    }
    ```

## 5.12.3 EXTRA_OEMAKE 변수 (The EXTRA_OEMAKE Variable)

`make` 명령어에 추가적인 인자를 전달해야 할 때 사용합니다.

* **예시**:

    ```bitbake
    EXTRA_OEMAKE = "CFLAGS='${CFLAGS} -DDEBUG'"
    ```

## 5.12.4 빌드 시스템 클래스 활용 (Using Build System Classes)

`autotools`, `cmake`, `meson` 등의 클래스를 상속받은 경우, 기본 `do_compile` 구현이 제공되므로 별도로 작성할 필요가 없는 경우가 많습니다.

* **Autotools**: `autotools` 클래스가 `oe_runmake`를 호출합니다.
* **CMake**: `cmake` 클래스가 `cmake --build` 또는 `make`를 호출합니다.

---
참고: 컴파일 단계에서 오류가 발생하면 `log.do_compile` 파일을 확인하여 원인을 분석해야 합니다. 헤더 파일 누락이나 링커 에러가 흔한 원인입니다.
