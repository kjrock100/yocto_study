# Yocto Project: 장치 인터페이스를 위한 헤더 사용 (Using Headers to Interface with Devices)

이 문서는 Yocto Project Development Tasks Manual의 5.11절을 기반으로, 애플리케이션이 하드웨어 장치와 상호 작용하기 위해 필요한 헤더 파일을 처리하는 방법에 대해 설명합니다.

## 5.11 개요 (Overview)

대부분의 경우, 애플리케이션은 `glibc`나 `musl`과 같은 표준 C 라이브러리에서 제공하는 헤더 파일을 통해 장치와 인터페이스합니다. 하지만 특정 하드웨어 기능이나 커널 드라이버에 접근하기 위해 리눅스 커널 헤더가 필요한 경우가 있습니다.

## 5.11.1 기본 커널 헤더 (Default Kernel Headers)

Yocto Project는 `linux-libc-headers` 레시피를 통해 사용자 공간(userspace)에서 사용할 수 있도록 정제된(sanitized) 커널 헤더를 제공합니다.

* 이 헤더들은 표준 C 라이브러리에 의해 사용되며, 대부분의 애플리케이션 빌드 시 기본적으로 시스템 루트(sysroot)에 포함됩니다.
* 따라서 일반적인 시스템 호출이나 표준 장치 인터페이스를 사용하는 경우 별도의 설정이 필요하지 않습니다.

## 5.11.2 커널 버전 의존성 (Kernel Version Dependency)

`linux-libc-headers`는 특정 커널 버전에 맞춰져 있습니다. 만약 애플리케이션이 실행될 타겟 시스템의 커널 버전보다 훨씬 최신의 헤더를 사용하여 빌드되면 호환성 문제가 발생할 수 있습니다.

* 일반적으로 `linux-libc-headers`의 버전은 Yocto 배포판 설정에 따라 결정됩니다.

## 5.11.3 사용자 정의 헤더 사용 (Using Custom Headers)

만약 커스텀 드라이버나 특정 커널 모듈에 대한 인터페이스 헤더가 필요한 경우, 해당 헤더를 제공하는 레시피를 작성하고 애플리케이션 레시피에서 이를 의존성으로 추가해야 합니다.

1. **헤더 제공 레시피**: 헤더 파일을 `${includedir}`에 설치하는 레시피를 작성합니다.
2. **의존성 추가**: 애플리케이션 레시피의 `DEPENDS` 변수에 해당 레시피를 추가합니다.

    ```bitbake
    DEPENDS += "my-custom-driver-headers"
    ```

---
참고: 커널 소스 전체(`virtual/kernel`)를 의존성으로 추가하는 것은 권장되지 않습니다. 이는 빌드 시간을 불필요하게 늘리고, 커널 소스가 사용자 공간 애플리케이션 빌드에 직접 사용되도록 설계되지 않았기 때문입니다. 대신 필요한 헤더만 별도로 패키징하거나 `linux-libc-headers`를 활용해야 합니다.
