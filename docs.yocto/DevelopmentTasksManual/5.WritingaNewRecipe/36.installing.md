# Yocto Project: 설치 (Installing)

이 문서는 Yocto Project Development Tasks Manual의 5.13절을 기반으로, 컴파일된 결과물을 패키징을 위해 임시 디렉토리로 복사하는 `do_install` 태스크와 관련 설정을 설명합니다.

## 5.13 개요 (Overview)

`do_compile` 태스크가 완료되면 BitBake는 `do_install` 태스크를 실행합니다. 이 단계의 목적은 빌드 디렉토리(`${B}`)에서 생성된 파일들을 패키징 단계에서 사용할 수 있도록 목적지 디렉토리(`${D}`)로 복사하는 것입니다.

## 5.13.1 목적지 디렉토리 (The Destination Directory - ${D})

`do_install` 태스크는 파일을 호스트 시스템의 루트(`/`)에 설치하는 것이 아니라, `${D}` 변수가 가리키는 디렉토리에 설치해야 합니다.

* **경로**: `${WORKDIR}/image`
* **주의사항**: 레시피 내에서 절대 경로(예: `/usr/bin`)를 직접 참조하여 설치하면 호스트 시스템을 오염시키거나 권한 오류가 발생할 수 있으므로 반드시 `${D}`를 접두어로 사용해야 합니다.

## 5.13.2 수동 설치 (Manual Install)

표준 빌드 시스템(Autotools, CMake 등)을 사용하지 않거나, 추가적인 파일을 설치해야 할 때는 `do_install` 함수를 직접 작성하여 `install` 명령어를 사용합니다.

* **install 명령어**: 디렉토리 생성 및 파일 복사, 권한 설정을 동시에 수행할 수 있는 유틸리티입니다.
* **예시**:

    ```bitbake
    do_install() {
        # 디렉토리 생성
        install -d ${D}${bindir}
        install -d ${D}${sysconfdir}

        # 실행 파일 설치 (권한 0755)
        install -m 0755 ${B}/myapp ${D}${bindir}

        # 설정 파일 설치 (권한 0644)
        install -m 0644 ${S}/myapp.conf ${D}${sysconfdir}
    }
    ```

## 5.13.3 빌드 시스템 클래스 활용 (Using Build System Classes)

`autotools`나 `cmake` 클래스를 상속받은 경우, 기본적으로 `make install` 또는 이에 상응하는 명령이 자동으로 실행됩니다.

* **Autotools**: `oe_runmake DESTDIR=${D} install`을 실행합니다.
* **CMake**: CMake의 설치 규칙에 따라 파일을 `${D}`로 복사합니다.

이 경우에도 추가적인 파일 설치가 필요하다면 `do_install:append`를 사용하여 작업을 추가할 수 있습니다.

```bitbake
do_install:append() {
    install -d ${D}${sysconfdir}
    install -m 0644 ${S}/extra.conf ${D}${sysconfdir}
}
```

---
참고: `do_install` 단계에서 설치된 파일들만 나중에 `do_package` 단계에서 패키지(IPK, RPM, DEB)로 묶일 수 있습니다. 설치되지 않은 파일은 패키지에 포함되지 않습니다.
