# Yocto Project: 외부 소스로 소프트웨어 빌드 (Building Software from an External Source)

이 문서는 Yocto Project Development Tasks Manual의 14.6절을 기반으로, 표준 Fetch/Unpack/Patch 과정을 거치지 않고 로컬 디렉토리에 있는 외부 소스 코드를 직접 사용하여 소프트웨어를 빌드하는 방법을 설명합니다.

## 14.6 개요 (Overview)

기본적으로 BitBake는 `SRC_URI`에서 소스를 다운로드하고 작업 디렉토리(`${WORKDIR}`)에 압축을 풉니다. 하지만 개발 중에는 로컬 Git 저장소나 소스 트리에서 직접 빌드하고 싶을 때가 있습니다. 이를 위해 `externalsrc` 클래스를 사용할 수 있습니다.

## 14.6.1 externalsrc 클래스 사용 (Using the externalsrc Class)

`externalsrc` 클래스를 상속받으면 BitBake가 `SRC_URI`를 무시하고, 지정된 로컬 경로의 소스 코드를 사용하여 빌드합니다.

* **설정 방법**:
    `local.conf` 파일에 다음과 같이 설정하여 특정 레시피가 외부 소스를 사용하도록 지정할 수 있습니다.

    ```bitbake
    INHERIT += "externalsrc"
    EXTERNALSRC:pn-<recipe-name> = "/path/to/your/source/tree"
    ```

* **예시**: `my-app` 레시피의 소스가 `/home/user/src/my-app`에 있는 경우

    ```bitbake
    INHERIT += "externalsrc"
    EXTERNALSRC:pn-my-app = "/home/user/src/my-app"
    ```

## 14.6.2 빌드 디렉토리 분리 (Separating the Build Directory)

기본적으로 `externalsrc`는 소스 디렉토리 내에서 빌드를 수행할 수 있지만(B=S), 소스와 빌드 아티팩트를 분리하고 싶다면 `EXTERNALSRC_BUILD` 변수를 설정합니다.

* **설정**:

    ```bitbake
    EXTERNALSRC_BUILD:pn-my-app = "/home/user/src/my-app/build"
    ```

## 14.6.3 제한 사항 (Limitations)

`externalsrc` 클래스를 사용하면 일반적인 빌드 흐름과 달라지는 점이 있습니다.

* **태스크 비활성화**: `do_fetch`, `do_unpack`, `do_patch` 태스크는 실행되지 않습니다. 소스 코드가 이미 로컬에 준비되어 있다고 가정하기 때문입니다.
* **패치 적용**: 레시피의 `SRC_URI`에 정의된 패치는 적용되지 않으므로, 필요한 변경 사항은 로컬 소스 트리에 직접 적용해야 합니다.

## 14.6.4 devtool과의 관계

`devtool modify` 명령어를 사용하면 내부적으로 `externalsrc` 클래스를 활용하여 작업 공간(Workspace)을 설정합니다. 따라서 수동으로 `externalsrc`를 설정하는 것보다 `devtool`을 사용하는 것이 더 편리하고 권장되는 방법입니다.

---
참고: `externalsrc`를 사용할 때는 소스 코드의 변경 사항이 BitBake에 의해 자동으로 감지되지 않을 수 있으므로, 코드를 수정한 후에는 명시적으로 빌드 태스크를 실행해야 할 수 있습니다.
