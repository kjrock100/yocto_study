# IMAGE_FEATURES 및 EXTRA_IMAGE_FEATURES를 사용한 이미지 커스터마이징

Yocto Project에서는 개별 패키지를 일일이 지정하는 대신, **기능(Feature)** 단위로 이미지를 구성할 수 있는 방법을 제공합니다. `IMAGE_FEATURES`와 `EXTRA_IMAGE_FEATURES` 변수를 사용하면 사전 정의된 패키지 그룹이나 시스템 설정을 쉽게 활성화할 수 있습니다.

## 1. 변수 설명

### 1.1. IMAGE_FEATURES

- **용도**: 이미지 레시피(`.bb`) 내부에서 해당 이미지가 포함해야 할 기능을 정의할 때 사용합니다.
- **기본값**: 대부분의 기본 이미지(예: `core-image-minimal`)는 빈 값이나 최소한의 기능을 가집니다.

### 1.2. EXTRA_IMAGE_FEATURES

- **용도**: `local.conf` 파일에서 주로 사용하며, 빌드되는 이미지에 추가적인 기능을 덧붙일 때 사용합니다.
- **특징**: 이 변수에 설정된 값은 자동으로 `IMAGE_FEATURES`에 추가됩니다. 개발 중에 디버깅 도구를 추가하거나 편의 기능을 켤 때 유용합니다.

## 2. 주요 기능 목록 (Supported Features)

Yocto Project에서 지원하는 주요 기능들은 다음과 같습니다.

| 기능 이름 | 설명 |
| :--- | :--- |
| **debug-tweaks** | 개발을 위한 편의 설정입니다. 루트 비밀번호를 비우거나(`empty-root-password`), 로그인 없이 루트 접근을 허용하는 등의 설정이 포함됩니다. 프로덕션 이미지에서는 제거해야 합니다. |
| **tools-sdk** | 타겟 장치에서 개발할 수 있도록 GCC, Make, 헤더 파일 등 SDK 도구를 설치합니다. |
| **tools-debug** | GDB, strace, perf 등 디버깅 및 프로파일링 도구를 설치합니다. |
| **tools-profile** | OProfile, LTTng, Valgrind 등 프로파일링 도구를 설치합니다. |
| **tools-testapps** | 장치 테스트를 위한 일반적인 테스트 애플리케이션들을 설치합니다. |
| **package-management** | 타겟 장치에서 패키지를 설치/제거할 수 있도록 패키지 관리자(RPM, IPK, DNF 등)와 데이터베이스를 설치합니다. |
| **ssh-server-openssh** | OpenSSH 서버를 설치합니다. (기본값은 보통 Dropbear일 수 있음) |
| **ssh-server-dropbear** | 경량 SSH 서버인 Dropbear를 설치합니다. |
| **read-only-rootfs** | 루트 파일시스템을 읽기 전용으로 설정합니다. |
| **splash** | 부팅 시 스플래시 화면을 표시합니다. |
| **x11** | X11 디스플레이 서버와 라이브러리를 포함합니다. |
| **x11-base** | 최소한의 X11 환경을 설치합니다. |
| **x11-sato** | Sato 데스크탑 환경을 설치합니다. |
| **weston** | Wayland 레퍼런스 컴포지터인 Weston을 설치합니다. |

## 3. 사용 예시

### 3.1. local.conf에서 사용 (개발 환경)

개발 중인 모든 이미지에 디버깅 도구와 루트 권한 편의 기능을 추가하고 싶다면 `conf/local.conf`에 다음과 같이 설정합니다.

```bash
EXTRA_IMAGE_FEATURES ?= "debug-tweaks tools-debug ssh-server-openssh"
```

### 3.2. 이미지 레시피에서 사용 (커스텀 이미지)

자신만의 이미지 레시피(`my-image.bb`)를 작성할 때는 `IMAGE_FEATURES`를 직접 정의하거나 확장합니다.

```bash
require recipes-core/images/core-image-minimal.bb

IMAGE_FEATURES += "package-management splash"
```

## 4. 주의사항

- **충돌**: 일부 기능은 서로 충돌할 수 있습니다. 예를 들어 `ssh-server-openssh`와 `ssh-server-dropbear`를 동시에 활성화하면 빌드 시스템이 경고를 보내거나 하나만 선택될 수 있습니다.
- **용량**: `tools-sdk`나 `tools-debug`와 같은 기능은 이미지 크기를 상당히 증가시킵니다. 최종 배포용 이미지에서는 제외하는 것이 좋습니다.


