# 레이어 호환성 확인 (Making Sure Your Layer is Compatible With Yocto Project)

Yocto Project 생태계에서 레이어가 다른 레이어들과 원활하게 작동하고, 공식적인 호환성을 인정받기 위해서는 호환성 검증 과정을 거쳐야 합니다. 이 문서는 `yocto-check-layer` 스크립트 사용법과 Yocto Project Compatible 프로그램에 대해 설명합니다.

## 1. Yocto Project Compatible 프로그램 (Yocto Project Compatible Program Application)

"Yocto Project Compatible" 배지는 해당 레이어가 Yocto Project의 표준과 모범 사례를 준수하며, 공식 릴리스와 호환됨을 보증합니다.

- **목적**: 사용자에게 레이어의 품질과 호환성에 대한 신뢰를 제공합니다.
- **신청 자격**: 오픈 소스 레이어 및 상용 레이어 모두 신청 가능합니다.
- **요건**:
  - `yocto-check-layer` 스크립트를 통과해야 합니다.
  - 레이어 이름 규칙(예: `meta-`)을 따라야 합니다.
  - 적절한 라이선스와 문서(README 등)를 포함해야 합니다.
  - Yocto Project의 릴리스 주기(6개월)에 맞춰 유지보수되어야 합니다.

## 2. yocto-check-layer 스크립트 (yocto-check-layer Script)

Yocto Project는 레이어의 호환성을 자동으로 검사할 수 있는 도구를 제공합니다. 이 스크립트는 레이어 구조, 메타데이터 유효성, 의존성 등을 검사합니다.

### 2.1. 스크립트 위치 및 준비

이 스크립트는 Poky 소스 트리의 `scripts/` 디렉토리에 위치합니다. 실행하기 전에 빌드 환경(`oe-init-build-env`)을 초기화해야 합니다.

### 2.2. 기본 사용법

가장 기본적인 사용법은 검사할 레이어의 경로를 인자로 전달하는 것입니다.

```bash
yocto-check-layer <path-to-your-layer>
```

예시:

```bash
yocto-check-layer ../meta-mylayer
```

### 2.3. 주요 검사 항목

스크립트는 다음과 같은 항목들을 검사합니다.

- **필수 파일 존재 여부**: `conf/layer.conf`, `README`, `COPYING` (또는 `LICENSE`) 파일이 있는지 확인합니다.
- **메타데이터 파싱**: 레이어 내의 모든 레시피와 설정 파일이 오류 없이 파싱되는지 확인합니다.
- **의존성 확인**: `LAYERDEPENDS`에 명시된 의존성 레이어가 존재하는지, 그리고 명시되지 않은 레이어에 의존하지 않는지 확인합니다.
- **시그니처 변경**: 레이어 추가 시 기존 시스템의 시그니처(Task Signature)를 불필요하게 변경하지 않는지 확인합니다.

### 2.4. 옵션

- `--dependency <layer-path>`: 검사 대상 레이어가 의존하는 다른 레이어를 지정합니다.

  ```bash
  yocto-check-layer --dependency ../meta-openembedded/meta-oe -- ../meta-mylayer
  ```

- `--output-log <file>`: 로그 결과를 파일로 저장합니다.

## 3. 호환성 검사 실패 시 조치

스크립트 실행 중 에러가 발생하면 로그를 확인하여 수정해야 합니다.

- **파싱 에러**: 문법 오류나 변수 오타를 수정합니다.
- **의존성 에러**: `conf/layer.conf`의 `LAYERDEPENDS` 변수를 수정하거나 필요한 레이어를 추가합니다.
- **구조 에러**: 필수 파일(README 등)을 추가하거나 디렉토리 구조를 표준에 맞게 변경합니다.
