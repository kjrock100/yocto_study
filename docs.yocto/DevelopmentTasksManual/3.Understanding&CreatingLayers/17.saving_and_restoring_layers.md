# 레이어 설정 저장 및 복원 (Saving and Restoring the Layers Setup)

Yocto Project 개발 시, 팀원들과 정확히 동일한 레이어 구성을 공유하거나 나중에 빌드 환경을 재현해야 할 때가 있습니다. `bitbake-layers` 스크립트의 `create-layers-setup` 서브 커맨드를 사용하면 현재 활성화된 레이어들의 상태(Git 리비전 등)를 스냅샷으로 저장하고 복원할 수 있습니다.

## 1. 레이어 설정 저장 (Saving the Setup)

현재 빌드 환경의 레이어 구성을 저장하려면 다음 명령어를 사용합니다.

```bash
bitbake-layers create-layers-setup <output-directory>
```

**예시**:

```bash
bitbake-layers create-layers-setup my-layer-setup
```

이 명령을 실행하면 `my-layer-setup` 디렉토리가 생성되고, 그 안에 다음 파일들이 포함됩니다.

- **setup-layers.json**: 레이어들의 경로, Git 리모트 URL, 리비전(commit hash) 정보를 담고 있는 JSON 파일입니다.
- **setup-layers**: 레이어 구성을 복원할 때 사용하는 Python 스크립트입니다.

## 2. 레이어 설정 복원 (Restoring the Setup)

저장된 설정을 사용하여 새로운 환경에서 레이어를 복원하려면, 생성된 디렉토리로 이동하여 `setup-layers` 스크립트를 실행합니다.

```bash
./setup-layers --destdir <destination-directory>
```

이 명령은 지정된 디렉토리에 필요한 레이어 저장소들을 클론(Clone)하고, 저장된 시점의 정확한 커밋으로 체크아웃합니다.

## 3. 활용 시나리오

- **팀 협업**: `setup-layers.json` 파일을 버전 관리 시스템에 포함시켜 팀원들이 동일한 레이어 버전을 사용하도록 강제할 수 있습니다.
- **CI/CD**: 빌드 서버에서 매번 동일한 환경을 구성하기 위해 사용할 수 있습니다.
- **릴리스 관리**: 제품 릴리스 시점의 레이어 상태를 보존하여 추후 유지보수나 디버깅 시 활용할 수 있습니다.
