# Yocto Project 워크스페이스 레이어 구조 (The Workspace Layer Structure)

Yocto Project에서 **워크스페이스 레이어(Workspace Layer)**는 `devtool` 도구를 사용할 때 생성되는 특별한 임시 레이어입니다. 개발 중인 레시피나 수정 사항을 담고 있으며, 빌드 시스템에서 가장 높은 우선순위를 가집니다.

## 1. 개요

`devtool`을 사용하여 레시피를 수정(`modify`)하거나 추가(`add`)하면, Yocto Project는 `build/workspace` 디렉토리에 이 레이어를 자동으로 구성합니다. 이 레이어는 `conf/bblayers.conf`에 자동으로 추가되며, 개발자가 작업을 완료(`finish`)하거나 초기화(`reset`)할 때까지 유지됩니다.

## 2. 디렉토리 구조

일반적인 워크스페이스 레이어(`build/workspace/`)의 구조는 다음과 같습니다.

### `conf/`
레이어 설정을 담고 있는 디렉토리입니다.
*   **`layer.conf`**: 워크스페이스 레이어의 정의와 우선순위(Priority)를 설정합니다. 워크스페이스 레이어는 보통 다른 모든 레이어보다 높은 우선순위(예: 99)를 가져, 개발 중인 변경 사항이 즉시 반영되도록 합니다.

### `appends/`
기존 레시피를 수정할 때 생성되는 `.bbappend` 파일들이 위치합니다.
*   `devtool modify` 명령을 실행하면, 원본 레시피에 대한 `bbappend` 파일이 이곳에 생성됩니다.
*   이 파일은 `externalsrc` 클래스를 상속받아, 빌드 시스템이 소스 코드를 `downloads` 디렉토리가 아닌 워크스페이스 내의 `sources` 디렉토리에서 가져오도록 설정합니다.

### `recipes/`
새로 추가된 레시피(`.bb`) 파일들이 위치합니다.
*   `devtool add` 명령을 실행하면, 생성된 기본 레시피 파일이 이곳에 저장됩니다.

### `sources/`
실제 소스 코드가 위치하는 디렉토리입니다.
*   레시피의 소스 코드가 압축 해제되어 이곳에 저장됩니다.
*   개발자는 이 디렉토리 내에서 소스 코드를 직접 수정하고, Git 커밋을 생성하며 작업을 진행합니다.
*   *참고: 엄밀히 말해 `sources` 디렉토리는 레이어 메타데이터의 일부는 아니지만, 워크스페이스의 핵심 구성 요소입니다.*

### `.devtool_md5`
`devtool`이 상태를 추적하기 위해 사용하는 내부 체크섬 파일입니다.

## 3. 작동 방식

1.  **우선순위:** 워크스페이스 레이어는 `BBFILE_PRIORITY`가 매우 높게 설정되어 있어, 동일한 이름의 레시피가 다른 레이어에 있더라도 워크스페이스의 설정이 우선 적용됩니다.
2.  **External Source:** `appends/` 내의 파일들은 `EXTERNALSRC` 변수를 사용하여 빌드 과정에서 `sources/` 디렉토리의 코드를 직접 컴파일하도록 지시합니다. 이를 통해 소스 수정 후 별도의 패키징 과정 없이 즉시 빌드 테스트가 가능합니다.

---
*참고: `devtool reset` 명령을 사용하면 해당 레시피 설정이 워크스페이스 레이어에서 제거됩니다.*
