# Yocto Project 레시피 업데이트 (Updating a Recipe)

Yocto Project에서 `devtool update-recipe` 명령어를 사용하여 워크스페이스에서 작업한 변경 사항을 레시피에 반영하는 방법에 대해 설명합니다.

## 1. 개요

`devtool update-recipe` 명령은 워크스페이스의 소스 트리에서 이루어진 변경 사항(Git 커밋)을 가져와서, 이를 패치 파일(`.patch`)로 생성하거나 `SRCREV`를 업데이트하는 방식으로 원본 레시피(`.bb`) 또는 `.bbappend` 파일에 적용합니다.

## 2. 기본 사용법

```bash
devtool update-recipe [options] <recipe>
```

*   **`<recipe>`**: 업데이트할 레시피의 이름입니다.

## 3. 작동 방식

1.  워크스페이스의 소스 디렉토리(`build/workspace/sources/<recipe>`)에서 초기 체크아웃 이후에 추가된 Git 커밋들을 분석합니다.
2.  각 커밋을 패치 파일로 변환하여 레시피 디렉토리(또는 `bbappend` 디렉토리)에 저장합니다.
3.  레시피 파일의 `SRC_URI` 변수를 수정하여 생성된 패치 파일을 포함시킵니다.

## 4. 주요 옵션

### 4.1 패치 모드 (`--mode=patch`)
기본 동작입니다. 변경 사항을 패치 파일로 만들어 레시피와 함께 저장합니다.

```bash
devtool update-recipe my-recipe
```

### 4.2 SRCREV 모드 (`--mode=srcrev`)
소스가 Git 저장소에서 관리되고 있고, 변경 사항을 해당 저장소에 푸시(Push)한 경우 사용합니다. 패치를 만드는 대신 레시피의 `SRCREV` 값을 최신 커밋 해시로 업데이트합니다.

```bash
devtool update-recipe --mode=srcrev my-recipe
```

### 4.3 bbappend 사용 (`--append`)
원본 레시피 파일을 수정하는 대신, 지정된 레이어에 `.bbappend` 파일을 생성하여 변경 사항을 저장합니다. 원본 레시피가 읽기 전용이거나 다른 레이어에 있을 때 유용합니다.

```bash
devtool update-recipe --append meta-mylayer my-recipe
```

## 5. `devtool finish`와의 차이점

*   **`devtool finish`**: 레시피를 업데이트한 후, 워크스페이스에서 해당 레시피를 **제거(Reset)**합니다. 작업이 완전히 끝났을 때 사용합니다.
*   **`devtool update-recipe`**: 레시피를 업데이트하지만, 워크스페이스의 상태는 **유지**합니다. 변경 사항을 중간 저장하고 계속 작업을 이어가고 싶을 때 사용합니다.

---
*참고: 변경 사항을 커밋하지 않은 상태에서 이 명령을 실행하면 적용되지 않으므로, 반드시 소스 디렉토리에서 `git commit`을 수행해야 합니다.*
