# Yocto Project 이미지 관련 작업 (Image-Related Tasks)

이 문서는 Yocto Project에서 이미지 레시피(예: `core-image-minimal`)를 빌드할 때 실행되는 주요 작업(Tasks)들에 대해 설명합니다. 이 작업들은 패키지 빌드 후, 최종적으로 타겟 장치에서 실행 가능한 파일시스템 이미지를 생성하는 과정을 담당합니다.

## 1. 핵심 이미지 생성 작업

### `do_rootfs`
*   **설명:** 이미지에 포함될 패키지(`IMAGE_INSTALL`에 정의됨)들을 설치하여 루트 파일시스템(Root Filesystem) 디렉토리 구조를 생성합니다.
*   **역할:** 패키지 매니저(RPM, DNF, OPKG 등)를 사용하여 `WORKDIR/rootfs` 디렉토리에 실제 파일들을 배치하고, 사용자 계정 생성, 설정 파일 수정 등의 후처리(Post-processing)를 수행합니다.

### `do_image`
*   **설명:** `do_rootfs`가 완료된 후 실행되며, 생성된 루트 파일시스템을 기반으로 실제 이미지 파일 생성을 위한 전처리를 수행합니다.
*   **역할:** 이 작업 자체보다는 `do_image_ext4`, `do_image_wic` 등 구체적인 이미지 타입별 작업들을 트리거하는 역할을 합니다.

### `do_image_complete`
*   **설명:** 모든 이미지 생성 작업이 완료된 후 실행되는 마무리 작업입니다.
*   **역할:** 최종 생성된 이미지 파일(예: `.wic`, `.ext4`, `.tar.bz2`)에 대한 심볼릭 링크를 생성하거나, 추가적인 메타데이터 처리를 수행하여 `tmp/deploy/images/` 디렉토리에 최종 결과물을 정리합니다.

## 2. 부팅 및 초기화 관련 작업

### `do_bootimg`
*   **설명:** 부팅 가능한 이미지를 생성합니다.
*   **역할:** 주로 라이브 이미지(Live Image)나 특정 부트로더가 필요한 이미지를 만들 때 사용되며, 커널과 루트 파일시스템을 결합하여 부팅 가능한 매체를 구성합니다.

### `do_bundle_initramfs`
*   **설명:** 커널 이미지와 Initramfs(Initial RAM Filesystem)를 하나로 묶습니다.
*   **역할:** `INITRAMFS_IMAGE` 변수가 설정된 경우, 커널 빌드 과정과 연계하여 단일 바이너리로 부팅 가능한 커널 이미지를 생성합니다.

## 3. 테스트 관련 작업

### `do_testimage`
*   **설명:** 빌드된 이미지를 부팅하여 런타임 테스트를 수행합니다.
*   **역할:** 주로 QEMU 에뮬레이터를 사용하여 이미지를 부팅하고, `TEST_SUITES` 변수에 정의된 테스트 케이스(예: Ping 테스트, SSH 접속, 시스템 서비스 확인 등)를 실행하여 이미지의 무결성을 검증합니다. `local.conf`에서 `INHERIT += "testimage"` 설정이 필요합니다.

### `do_testimage_auto`
*   **설명:** 이미지가 빌드된 직후 자동으로 `do_testimage`를 실행하도록 합니다.
*   **역할:** CI(Continuous Integration) 환경에서 빌드와 테스트를 자동화할 때 유용합니다.

---
*참고: 이 내용은 Yocto Project 참조 매뉴얼의 'Image-Related Tasks' 섹션을 기반으로 작성되었습니다.*
