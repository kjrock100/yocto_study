# devtool 빠른 참조

`devtool` 명령행 도구는 소프트웨어를 빌드, 테스트 및 패키징하는 데 도움이 되는 여러 기능을 제공합니다. 이 명령은 `bitbake` 명령과 함께 사용할 수 있습니다. 또한 `devtool` 명령은 확장 가능 SDK의 핵심 부분입니다.

이 장은 `devtool` 명령의 빠른 참조를 제공합니다. 확장 가능 SDK를 사용할 때 명령을 적용하는 방법에 대한 자세한 내용은 Yocto 프로젝트 애플리케이션 개발 및 확장 가능 소프트웨어 개발 키트(eSDK) 매뉴얼의 "확장 가능 SDK 사용" 장을 참조하세요.

## 7.1 도움말 얻기

`devtool` 명령행은 Git과 유사하게 각 기능에 대한 여러 하위 명령을 가지고 있습니다. `devtool --help`를 실행하여 모든 명령을 볼 수 있습니다:

```bash
$ devtool --help
```

일반 도움말 출력이 지시하는 대로, 명령 이름을 제공하고 `--help`를 사용하여 특정 명령에 대한 더 많은 구문을 얻을 수 있습니다:

```bash
$ devtool add --help
```

주요 하위 명령:

**레시피 작업 시작:**

- `add` - 새 레시피 추가
- `modify` - 기존 레시피의 소스 수정
- `upgrade` - 기존 레시피 업그레이드

**정보 얻기:**

- `status` - 작업 영역 상태 표시
- `latest-version` - 기존 레시피의 최신 버전 보고
- `check-upgrade-status` - 여러 (또는 모든) 레시피의 업그레이드 가능성 보고
- `search` - 사용 가능한 레시피 검색

**작업 영역에서 레시피 작업:**

- `build` - 레시피 빌드
- `ide-sdk` - SDK 설정 및 IDE 구성
- `rename` - 작업 영역의 레시피 파일 이름 바꾸기
- `edit-recipe` - 레시피 파일 편집
- `find-recipe` - 레시피 파일 찾기
- `configure-help` - 구성 스크립트 옵션에 대한 도움말 얻기
- `update-recipe` - 외부 소스 트리의 변경 사항을 레시피에 적용
- `reset` - 작업 영역에서 레시피 제거
- `finish` - 작업 영역의 레시피에 대한 작업 완료

**대상에서 변경 사항 테스트:**

- `deploy-target` - 레시피 출력 파일을 라이브 대상 머신에 배포
- `undeploy-target` - 레시피 출력 파일을 라이브 대상 머신에서 배포 해제
- `build-image` - 작업 영역 레시피 패키지를 포함하는 이미지 빌드

**고급:**

- `create-workspace` - 대체 위치에 작업 영역 설정
- `import` - 내보낸 tar 아카이브를 작업 영역으로 가져오기
- `export` - 작업 영역을 tar 아카이브로 내보내기
- `extract` - 기존 레시피의 소스 추출
- `sync` - 기존 레시피의 소스 트리 동기화
- `menuconfig` - 레시피의 빌드 시간 구성 변경

## 7.2 작업 영역 레이어 구조

`devtool`은 빌드를 수행하기 위한 "Workspace" 레이어를 사용합니다. 이 레이어는 특정 `devtool` 명령에 국한되지 않고 도구 전체에서 사용하는 공통 작업 영역입니다.

작업 영역 디렉토리 구조:

- **attic** - devtool이 "devtool reset" 실행 시 무언가를 보존해야 한다고 판단하면 생성되는 디렉토리입니다.

- **README** - 작업 영역 레이어에 있는 내용과 이를 관리하는 방법에 대한 정보를 제공합니다.

- **.devtool_md5** - devtool에서 사용하는 체크섬 파일입니다.

- **appends** - 외부 소스를 가리키는 `*.bbappend` 파일을 포함하는 디렉토리입니다.

- **conf** - `layer.conf` 파일을 포함하는 구성 디렉토리입니다.

- **recipes** - 레시피를 포함하는 디렉토리입니다. 이 디렉토리에는 추가된 각 디렉토리에 대한 폴더가 포함되며, 이름은 추가된 레시피의 이름과 일치합니다. devtool은 해당 하위 디렉토리 내에 `recipe.bb` 파일을 배치합니다.

- **sources** - 레시피를 빌드할 때 사용되는 소스 파일의 작업 복사본을 포함하는 디렉토리입니다. 소스 트리 경로를 제공하지 않을 때 사용되는 기본 디렉토리입니다.

## 7.3 작업 영역 레이어에 새 레시피 추가

`devtool add` 명령을 사용하여 작업 영역 레이어에 새 레시피를 추가합니다. 추가하는 레시피는 존재하지 않아야 합니다. `devtool`이 생성합니다. 레시피가 사용하는 소스 파일은 외부 영역에 존재해야 합니다.

다음 예제는 도구가 생성하는 작업 영역 레이어에 `jackson`이라는 새 레시피를 생성하고 추가합니다. 레시피로 빌드된 소스 코드는 `/home/user/sources/jackson`에 있습니다:

```bash
$ devtool add jackson /home/user/sources/jackson
```

레시피를 추가하고 작업 영역 레이어가 존재하지 않으면 명령이 레이어를 생성하고 "The Workspace Layer Structure" 섹션에 설명된 대로 채웁니다.

작업 영역 레이어가 존재할 때 `devtool add`를 실행하면 도구가 기존 작업 영역 레이어에 레시피, 추가 파일 및 소스 파일을 추가합니다. `.bbappend` 파일이 생성되어 외부 소스 트리를 가리킵니다.

> **참고:** 레시피에 정의된 런타임 종속성이 있는 경우, 애플리케이션을 실행하려고 시도하기 전에 이 패키지가 대상 하드웨어에 있는지 확인해야 합니다.

기본적으로 `devtool add`는 원격 URI에서 파일을 압축 해제할 때 최신 수정본(즉, master)을 사용합니다. 경우에 따라 분기, 태그 또는 커밋 해시로 소스 수정본을 지정할 수 있습니다:

**분기 지정:**

```bash
$ devtool add --srcbranch walnascar jackson /home/user/sources/jackson
```

**태그 또는 커밋 해시 지정:**

```bash
$ devtool add --srcrev yocto-5.0 jackson /home/user/sources/jackson
$ devtool add --srcrev some_commit_hash jackson /home/user/sources/jackson
```

> **참고:** 매번 레시피가 빌드될 때마다 최신 수정본을 사용하려면 `--autorev` 또는 `-a` 옵션을 사용합니다.

## 7.4 기존 레시피의 소스 추출

`devtool extract` 명령을 사용하여 기존 레시피의 소스를 추출합니다. 이 명령을 사용할 때는 레시피의 루트 이름(즉, 버전, 경로 또는 확장자 없음)을 제공해야 하며, 소스를 추출할 디렉토리를 제공해야 합니다.

추가 명령 옵션을 통해 소스를 체크아웃할 개발 분기의 이름과 디버깅에 유용한 임시 디렉토리를 유지할지 여부를 제어할 수 있습니다.

## 7.5 레시피의 추출된 소스 트리 동기화

`devtool sync` 명령을 사용하여 기존 레시피에 대해 이전에 추출한 소스 트리를 동기화합니다. 이 명령을 사용할 때는 레시피의 루트 이름(즉, 버전, 경로 또는 확장자 없음)을 제공해야 하며, 소스를 추출할 디렉토리를 제공해야 합니다.

## 7.6 기존 레시피 수정

`devtool modify` 명령을 사용하여 기존 레시피의 소스 수정을 시작합니다. 이 명령은 추가 명령과 매우 유사하지만, 레시피가 이미 다른 레이어에 존재하므로 작업 영역 레이어에 물리적으로 레시피를 생성하지 않습니다.

`devtool modify` 명령은 레시피의 소스를 추출하고, 소스를 Git에서 가져오지 않은 경우 Git 리포지토리로 설정하고, 개발을 위한 분기를 체크아웃하고, 레시피의 패치를 상단에 커밋으로 적용합니다:

```bash
$ devtool modify recipe
```

## 7.7 기존 레시피 편집

`devtool edit-recipe` 명령을 사용하여 `EDITOR` 변수로 식별되는 기본 편집기를 지정된 레시피에서 실행합니다.

`devtool edit-recipe` 명령을 사용할 때 레시피의 루트 이름(즉, 버전, 경로 또는 확장자 없음)을 제공해야 합니다. 또한 레시피 파일 자체는 `devtool add` 또는 `devtool upgrade` 명령의 결과로 작업 영역에 있어야 합니다.

## 7.8 레시피 업데이트

`devtool update-recipe` 명령을 사용하여 소스 파일에 대한 변경 사항을 반영하는 패치로 레시피를 업데이트합니다. 예를 들어, 일부 코드에서 작업할 계획이면 먼저 `devtool modify` 명령을 사용하여 코드를 추출하고 작업 영역을 설정합니다. 그 후 코드를 수정, 컴파일 및 테스트합니다.

결과에 만족하고 Git 리포지토리에 변경 사항을 커밋한 후 `devtool update-recipe`를 실행하여 패치를 생성하고 레시피를 업데이트할 수 있습니다:

```bash
$ devtool update-recipe recipe
```

`devtool update-recipe`를 변경 사항을 커밋하지 않고 실행하면 명령은 변경 사항을 무시합니다.

종종 소프트웨어에 대한 커스터마이징을 원본 레시피가 아닌 자신의 레이어에 적용하고 싶을 수 있습니다. 이 경우 `devtool update-recipe` 명령과 함께 `-a` 또는 `--append` 옵션을 사용할 수 있습니다. 이 옵션을 사용하면 추가 파일을 작성할 레이어를 지정할 수 있습니다:

```bash
$ devtool update-recipe recipe -a base-layer-directory
```

`*.bbappend` 파일이 지정된 레이어 디렉토리 내의 적절한 경로에 생성됩니다. 추가 파일이 이미 존재하면 명령이 적절하게 업데이트합니다.

## 7.9 레시피의 업그레이드 상태 확인

업스트림 레시피는 시간이 지남에 따라 변합니다. 결과적으로 레시피를 더 새로운 버전으로 업그레이드할 수 있는지 확인해야 할 수 있습니다.

레시피의 업그레이드 상태를 확인하려면 `devtool latest-version recipe` 명령을 사용할 수 있습니다. 이 명령은 현재 버전과 업스트림에서 사용 가능한 최신 버전을 빠르게 표시합니다. 더 많은 정보를 보려면 `devtool check-upgrade-status` 명령을 사용하십시오. 이 명령은 레시피 목록을 입력으로 받거나 인수 없이 모든 사용 가능한 레시피를 확인합니다.

```bash
$ devtool check-upgrade-status
```

## 7.10 레시피 업그레이드

소프트웨어가 성숙해짐에 따라 업스트림 레시피는 더 새로운 버전으로 업그레이드됩니다. 개발자는 로컬 레시피를 업스트림 버전 릴리스로 최신 상태로 유지해야 합니다.

`devtool upgrade` 명령은 기존 레시피를 더 최근 버전으로 업그레이드합니다. 명령은 업그레이드된 레시피 파일과 관련 파일을 "작업 영역"에 배치하고, 필요한 경우 소스 트리를 지정된 위치로 추출합니다. 업그레이드 중에 레시피와 관련된 패치가 다시 기반화되거나 필요에 따라 추가됩니다.

`devtool upgrade` 명령을 사용할 때 레시피의 루트 이름(즉, 버전, 경로 또는 확장자 없음)을 제공해야 하며, 소스를 추출할 디렉토리를 제공해야 합니다.

## 7.11 레시피 리셋

`devtool reset` 명령을 사용하여 레시피 및 해당 구성(예: 해당 `.bbappend` 파일)을 작업 영역 레이어에서 제거합니다. 이 명령은 레시피 및 추가 파일을 삭제합니다. 명령은 물리적으로 이동하지 않습니다. 결과적으로 `devtool reset` 명령을 실행하기 전에 업데이트된 레시피와 추가 파일을 작업 영역 레이어 외부로 물리적으로 재배치해야 합니다.

`devtool reset` 명령이 레시피 또는 추가 파일이 수정되었음을 감지하면, 명령은 수정된 파일을 작업 영역 레이어 아래의 별도 "attic" 하위 디렉토리에 보존합니다.

예제:

```bash
$ devtool reset mtr
```

## 7.12 레시피 작업 완료

`devtool finish` 명령을 사용하여 지정된 레이어의 지정된 레시피에 커밋된 변경 사항을 푸시하고 작업 영역에서 제거합니다.

이는 대략 `devtool update-recipe` 명령 다음에 `devtool reset` 명령과 같습니다. 변경 사항은 `devtool`에 의해 생성된 git 리포지토리에 커밋되어야 합니다:

```bash
$ devtool finish recipe /path/to/custom/layer
```

## 7.13 레시피 빌드

`devtool build` 명령을 사용하여 레시피를 빌드합니다. `devtool build` 명령은 `bitbake -c populate_sysroot` 명령과 동등합니다.

`devtool build` 명령을 사용할 때 레시피의 루트 이름(즉, 버전, 경로 또는 확장자를 제공하지 마세요)을 제공해야 합니다:

```bash
$ devtool build recipe
```

## 7.14 이미지 빌드

`devtool build-image` 명령을 사용하여 이미지를 빌드하고 작업 영역의 레시피에서 패키지를 포함하도록 확장합니다. 이 명령을 사용하면 디바이스에 즉시 배포하기 위해 준비된 이미지를 원할 때 유용합니다:

```bash
$ devtool build-image image
```

## 7.15 대상 머신에 소프트웨어 배포

`devtool deploy-target` 명령을 사용하여 레시피의 빌드 출력을 라이브 대상 머신에 배포합니다:

```bash
$ devtool deploy-target recipe target
```

대상은 SSH 서버를 실행 중인 대상 머신의 주소입니다(즉, `user@hostname[:destdir]`).

이 명령은 `do_install` 작업 중에 설치된 모든 파일을 배포합니다. 또한 대상 머신에서 패키지 관리를 사용 가능하게 할 필요가 없습니다. 사용 가능하면 패키지 관리자가 무시됩니다.

> **참고:** `deploy-target` 기능은 개발 전용입니다. 프로덕션에서 사용될 이미지를 업데이트하는 데 사용하면 안 됩니다.

배포된 애플리케이션이 예상대로 작동하지 않을 수 있는 조건이 있습니다. 다음 조건이 모두 충족되면 애플리케이션이 대상에서 실행될 때 올바르게 작동하지 않을 가능성이 있습니다:

- 새 애플리케이션을 대상에 배포 중이고 애플리케이션을 빌드하는 데 사용한 레시피에 런타임 종속성이 올바르게 정의되어 있습니다.
- 대상에 애플리케이션이 의존하는 패키지가 물리적으로 설치되지 않았습니다.

이 두 조건이 모두 충족되면 애플리케이션이 예상대로 작동하지 않습니다. 이 오작동의 이유는 `devtool deploy-target` 명령이 새 애플리케이션이 의존하는 패키지(예: 라이브러리)를 배포하지 않기 때문입니다.

## 7.16 대상 머신에서 소프트웨어 제거

`devtool undeploy-target` 명령을 사용하여 대상 머신에서 배포된 빌드 출력을 제거합니다. `devtool undeploy-target` 명령이 작동하려면 이전에 "devtool deploy-target" 명령을 사용했어야 합니다:

```bash
$ devtool undeploy-target recipe target
```

## 7.17 대체 위치에서 작업 영역 레이어 생성

`devtool create-workspace` 명령을 사용하여 빌드 디렉토리에서 새 작업 영역 레이어를 생성합니다. 새 작업 영역 레이어를 생성하면 `README` 파일과 `conf` 디렉토리만으로 채워집니다.

다음 예제는 현재 작업 디렉토리에서 새 작업 영역 레이어를 생성하고 기본적으로 작업 영역 레이어 이름을 "workspace"로 지정합니다:

```bash
$ devtool create-workspace
```

경로를 제공하여 어디서나 작업 영역 레이어를 생성할 수 있습니다. 다음 명령은 "new-workspace"라는 새 작업 영역 레이어를 생성합니다:

```bash
$ devtool create-workspace /home/user/new-workspace
```

## 7.18 작업 영역의 레시피 상태 얻기

`devtool status` 명령을 사용하여 작업 영역에 현재 있는 레시피를 나열합니다. 정보에는 각각의 외부 소스 트리에 대한 경로가 포함됩니다:

```bash
$ devtool status
```

## 7.19 사용 가능한 대상 레시피 검색

`devtool search` 명령을 사용하여 사용 가능한 대상 레시피를 검색합니다. 명령은 레시피 이름, 패키지 이름, 설명 및 설치된 파일과 일치합니다. 명령은 매칭 결과로 레시피 이름을 표시합니다.

`devtool search` 명령을 사용할 때 키워드를 제공해야 합니다. 명령은 매칭을 검색할 때 키워드를 사용합니다.

또는 `devtool find-recipe` 명령을 사용하여 레시피 이름 대신 레시피 파일을 검색할 수 있습니다. 마찬가지로 키워드를 제공해야 합니다.

## 7.20 레시피 구성 스크립트에 대한 정보 얻기

`devtool configure-help` 명령을 사용하여 주어진 레시피의 구성 스크립트 옵션에 대한 도움말을 얻습니다. 명령에 레시피 이름을 제공해야 합니다. 예를 들어, autotools 기반 레시피에 대해 `./configure --help`의 출력을 표시합니다.

`configure-help` 명령은 `EXTRA_OECONF` 변수를 통해 전달된 것들을 포함하여 현재 사용 중인 구성 옵션을 표시합니다.

## 7.21 레시피에 대한 IDE 구성 생성

`devtool ide-sdk` 명령은 주어진 레시피에서 작업할 IDE 구성과 SDK를 자동으로 생성합니다. `--mode` 매개변수에 따라 다양한 유형의 SDK가 생성됩니다:

- **modified 모드**: 작업 영역 디렉토리에 SDK를 생성하고 IDE 구성을 생성합니다.
- **shared 모드**: 교차 컴파일 도구 체인과 제공된 레시피(들)의 해당 공유 sysroot 디렉토리를 생성합니다.

`--target` 옵션을 사용하여 `username@hostname` 문자열을 지정하고 레시피에 대한 원격 디버깅 구성을 생성할 수 있습니다. `devtool deploy-target`과 유사하게, 대상에서 실행 중인 SSH 서버가 필요합니다.

`devtool ide-sdk` 명령에 대한 자세한 내용은 Yocto 프로젝트 애플리케이션 개발 및 확장 가능 소프트웨어 개발 키트(eSDK) 매뉴얼의 "확장 가능 SDK 사용" 장을 참조하세요.
