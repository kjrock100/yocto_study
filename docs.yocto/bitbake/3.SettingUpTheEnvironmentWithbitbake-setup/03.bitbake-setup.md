# BitBake 환경 설정 (Setting Up The Environment With bitbake-setup)

`bitbake-setup`은 BitBake 빌드 환경을 보다 쉽고 재현 가능하게 구성하고 관리하기 위해 도입된 도구입니다. 복잡한 레이어 설정과 `conf` 파일 수정을 자동화하여 프로젝트 설정을 단순화합니다.

## 3.1 빠른 시작 (Quick Start)

가장 기본적인 사용법은 프로젝트의 설정 파일이 있는 디렉토리에서 초기화를 수행하는 것입니다.

```bash
# 설정 파일을 기반으로 빌드 디렉토리 초기화
bitbake-setup init --path build

# 빌드 디렉토리로 이동하여 빌드 수행
cd build
bitbake core-image-minimal
```

## 3.2 용어 (Terminology)

*   **Setup Definition**: 빌드 환경을 구성하는 레이어 목록, 소스 저장소 위치, `local.conf` 설정 변수 등을 정의한 파일(주로 JSON 또는 YAML)입니다.
*   **Build Directory**: 실제 빌드가 수행되는 디렉토리로, `bitbake-setup`에 의해 `conf/local.conf`와 `conf/bblayers.conf`가 생성되는 곳입니다.

## 3.3 bitbake-setup 명령어 (The bitbake-setup command)

### 3.3.1 bitbake-setup init

지정된 설정(Setup Definition)을 바탕으로 빌드 디렉토리를 생성하고 초기화합니다. 필요한 레이어 저장소를 다운로드(fetch)하고 설정 파일을 생성합니다.

#### 3.3.1.1 bitbake-setup init 예제

```bash
# 기본 설정을 사용하여 'build' 디렉토리 초기화
bitbake-setup init --path build

# 특정 설정 파일을 명시적으로 지정하여 초기화
bitbake-setup init --path build --config my-custom-setup.json
```

### 3.3.2 bitbake-setup list

현재 환경에서 사용 가능한 설정(Setup Definition)들의 목록을 검색하여 보여줍니다.

### 3.3.3 bitbake-setup status

현재 빌드 디렉토리의 상태를 확인합니다. 정의된 설정과 실제 구성된 환경(레이어 리비전 등) 간의 차이가 있는지 검사합니다.

### 3.3.4 bitbake-setup update

설정 파일(Setup Definition)이 변경되었거나 레이어의 리비전이 업데이트되었을 때, 이를 현재 빌드 환경에 반영합니다.

### 3.3.5 bitbake-setup install-buildtools

호스트 시스템의 리눅스 배포판 버전이 너무 오래되어 BitBake를 실행할 수 없는 경우, 필요한 최신 빌드 도구 모음(Buildtools tarball)을 자동으로 다운로드하고 설치하는 헬퍼 명령어입니다.

### 3.3.6 bitbake-setup settings

`bitbake-setup` 도구 자체의 전역 설정을 확인하거나 수정합니다.

## 3.4 설정 (Settings)

`bitbake-setup`의 동작 방식을 제어하는 주요 설정 항목들입니다.

### 3.4.1 top-dir-prefix
빌드 디렉토리가 생성될 기본 상위 경로를 지정합니다.

### 3.4.2 top-dir-name
생성될 빌드 디렉토리의 기본 명명 규칙을 지정합니다.

### 3.4.3 registry
설정 파일들을 찾을 수 있는 레지스트리나 기본 경로를 지정합니다.

### 3.4.4 dl-dir
소스 코드를 다운로드할 공용 디렉토리(`DL_DIR`) 경로를 지정하여, 여러 빌드 프로젝트 간에 다운로드된 파일을 공유하여 디스크 공간과 시간을 절약할 수 있게 합니다.

## 3.5 일반 설정 파일 참조 (Generic Configuration Files Reference)

설정 파일은 프로젝트의 구성을 서술합니다.

*   **Sources**: 레이어를 가져올 Git 저장소 URL, 브랜치, 리비전.
*   **Layers**: 해당 저장소 내에서 활성화할 레이어 경로.
*   **Configuration**: `local.conf`에 추가될 변수들 (`MACHINE`, `DISTRO` 등).

## 3.6 소스 재정의 (Source Overrides)

개발 중에는 원격 저장소 대신 로컬에 있는 소스 코드를 사용해야 할 때가 있습니다. `bitbake-setup`은 설정 파일을 직접 수정하지 않고도, 외부 설정이나 인자를 통해 특정 레이어의 소스 경로를 로컬 경로로 덮어쓰는(Override) 기능을 제공하여 개발 편의성을 높입니다.
