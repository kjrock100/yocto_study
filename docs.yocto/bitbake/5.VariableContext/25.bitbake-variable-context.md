# 변수 컨텍스트 (Variable Context)

BitBake 변수는 정의되는 위치와 시점에 따라 유효 범위(Scope)와 수명(Lifetime)이 달라집니다. 이를 이해하는 것은 변수가 예상대로 동작하지 않을 때 디버깅하는 데 중요합니다.

## 5.1 BitBake 자체 설정 (BitBake’s own configuration)

BitBake 실행 시 가장 먼저 로드되는 컨텍스트입니다. 주로 `meta/conf/bitbake.conf` 파일에 의해 정의됩니다.
*   시스템 전반의 기본값(예: 파일 확장자, 기본 경로 구조)을 설정합니다.
*   이 변수들은 이후의 모든 설정 및 레시피 파싱 과정에서 기본값으로 사용됩니다.

## 5.2 BitBake 설정 (BitBake configuration)

사용자가 빌드 환경을 커스터마이징하는 단계입니다.
*   **`local.conf`**: 사용자가 직접 수정하는 파일로, `MACHINE`, `DL_DIR` 등 빌드 전체에 영향을 미치는 전역 변수를 설정합니다.
*   **`site.conf`**: 여러 빌드 디렉토리 간에 공유되는 설정을 담을 수 있습니다.

이 단계에서 정의된 변수들은 **전역 설정(Global Configuration)**으로 간주되어, 모든 레시피에 상속됩니다.

## 5.3 레이어와 파일 (Layers and files)

`bblayers.conf`에 정의된 각 레이어의 `conf/layer.conf` 파일이 파싱되는 단계입니다.
*   `BBPATH`와 `BBFILES`를 설정하여 BitBake가 레시피와 클래스 파일을 찾을 수 있게 합니다.
*   레이어별 우선순위(`BBFILE_PRIORITY`)를 설정합니다.

## 5.4 레시피와 패키지 (Recipes and packages)

개별 레시피(`.bb`) 파일이 파싱될 때 형성되는 컨텍스트입니다.

*   **독립성**: 각 레시피는 전역 설정(Configuration)의 복사본을 기반으로 자신만의 데이터 저장소(Datastore)를 가집니다.
*   **지역성**: 레시피 내에서 `PN = "my-package"`와 같이 변수를 설정하면, 이는 해당 레시피 컨텍스트 내에서만 유효하며 다른 레시피나 전역 설정에 영향을 주지 않습니다.
*   **패키지 변수**: `RDEPENDS`, `FILES` 등과 같이 패키지별로 적용되는 변수들은 `RDEPENDS:${PN}`과 같이 오버라이드 문법을 사용하여 특정 패키지 컨텍스트에 값을 할당합니다.

### 요약: 변수 전파 과정

1.  **초기화**: `bitbake.conf` + `local.conf` + `layer.conf` -> **전역 설정 데이터** 생성.
2.  **레시피 파싱**: 전역 설정 데이터 복사 -> 레시피 파일 내용 적용 -> **레시피별 데이터 저장소** 생성.
3.  **태스크 실행**: 레시피별 데이터 저장소 사용.
