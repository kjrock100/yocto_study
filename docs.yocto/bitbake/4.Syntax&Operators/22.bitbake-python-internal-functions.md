# Python 내에서 호출할 수 있는 함수 (Functions You Can Call From Within Python)

BitBake의 파이썬 함수(태스크, 이벤트 핸들러, 인라인 파이썬 등) 내부에서는 BitBake 인프라가 제공하는 다양한 API를 사용할 수 있습니다. 주로 데이터 저장소(`d`)를 조작하거나 로깅을 수행하는 함수들입니다.

## 4.11.1 데이터 저장소 변수 접근 함수 (Functions for Accessing Datastore Variables)

파이썬 함수 내에서 `d` 객체(Datastore)를 통해 변수에 접근하고 수정할 수 있습니다.

*   **`d.getVar("VAR", expand=True)`**: 변수 `VAR`의 값을 가져옵니다. `expand=True`가 기본값이며, 변수 내의 참조(`${...}`)를 모두 확장하여 반환합니다. `expand=False`로 설정하면 확장되지 않은 원본 문자열을 반환합니다.
*   **`d.setVar("VAR", "value")`**: 변수 `VAR`의 값을 `value`로 설정합니다.
*   **`d.appendVar("VAR", "value")`**: 변수 `VAR`의 현재 값 뒤에 `value`를 추가합니다. (공백은 자동으로 추가되지 않습니다.)
*   **`d.prependVar("VAR", "value")`**: 변수 `VAR`의 현재 값 앞에 `value`를 추가합니다.
*   **`d.delVar("VAR")`**: 변수 `VAR`를 삭제합니다.
*   **`d.renameVar("FROM", "TO")`**: 변수 이름을 `FROM`에서 `TO`로 변경합니다.
*   **`d.getVarFlag("VAR", "flag")`**: 변수 `VAR`의 플래그 `flag` 값을 가져옵니다.
*   **`d.setVarFlag("VAR", "flag", "value")`**: 변수 `VAR`의 플래그 `flag` 값을 설정합니다.

```python
python do_example() {
    val = d.getVar("S")
    d.setVar("B", val)
    d.appendVar("CFLAGS", " -O2")
}
```

## 4.11.2 기타 함수 (Other Functions)

### 로깅 함수 (Logging Functions)
`bb` 모듈을 통해 로그를 출력할 수 있습니다.

*   **`bb.plain("msg")`**: 일반 텍스트를 출력합니다.
*   **`bb.note("msg")`**: 정보성 메시지(Note)를 출력합니다.
*   **`bb.warn("msg")`**: 경고 메시지(Warning)를 출력합니다.
*   **`bb.error("msg")`**: 에러 메시지(Error)를 출력합니다. 빌드가 즉시 중단되지는 않습니다.
*   **`bb.fatal("msg")`**: 치명적 에러(Fatal)를 출력하고 빌드를 즉시 중단합니다.
*   **`bb.debug(level, "msg")`**: 디버그 레벨에 따라 메시지를 출력합니다.

### 유틸리티 함수 (Utility Functions)
`bb.utils` 모듈은 다양한 유틸리티 함수를 제공합니다.

*   **`bb.utils.contains("VAR", "val", "true_val", "false_val", d)`**: 변수 `VAR`의 값(리스트)에 `val`이 포함되어 있으면 `true_val`을, 그렇지 않으면 `false_val`을 반환합니다. `DISTRO_FEATURES`나 `PACKAGECONFIG` 확인 시 매우 자주 사용됩니다.
*   **`bb.utils.mkdirhier("path")`**: 디렉토리를 재귀적으로 생성합니다 (`mkdir -p`와 유사).
*   **`bb.utils.export_proxies(d)`**: 프록시 관련 환경 변수들을 내보냅니다.

```python
EXTRA_OECONF += "${@bb.utils.contains('DISTRO_FEATURES', 'systemd', '--with-systemd', '--without-systemd', d)}"
```

## 4.11.3 Python 라이브러리 코드 확장 (Extending Python Library Code)
BitBake는 `lib/bb` 디렉토리 내에 자체 파이썬 라이브러리를 가지고 있습니다. 고급 사용자는 이 코드를 참조하거나 확장하여 BitBake의 핵심 기능을 변경할 수 있습니다.

## 4.11.4 테스트 및 디버깅 (Testing and Debugging)
`bitbake-selftest` 명령어를 사용하여 BitBake 내부의 파이썬 코드와 기능들을 테스트할 수 있습니다.
