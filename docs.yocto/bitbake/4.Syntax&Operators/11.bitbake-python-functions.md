# 파이썬 함수 (Python Functions)

BitBake는 BitBake 스타일 파이썬 함수 외에도, 일반적인 파이썬 모듈에서 볼 수 있는 표준 `def` 문법을 사용한 함수 정의와 이름 없는 익명 함수를 지원합니다.

## 4.5.3 표준 파이썬 함수 (Standard Python Functions)

표준 파이썬 함수는 `def` 키워드를 사용하여 정의하며, 주로 변수 확장 구문(`${@...}`) 내에서 호출되어 특정 값을 계산하고 반환하는 유틸리티 함수로 사용됩니다.

### 4.5.3.1 함수 정의 및 사용법

```bitbake
# d(datastore)를 인자로 받아 조건에 따라 다른 값을 반환하는 함수
def get_depends(d):
    if d.getVar('SOMECONDITION'):
        return "dependencywithcond"
    return "dependency"

# 변수 할당 시점에 함수를 호출하여 그 결과를 값으로 사용
VAR = "${@get_depends(d)}"
```

**주요 특징:**

*   **`def` 키워드**: 표준 파이썬 문법과 동일하게 `def`로 함수를 정의합니다.
*   **명시적인 `d` 전달**: BitBake 데이터 저장소(Datastore)에 접근해야 할 경우, 반드시 `d` 객체를 함수의 인자로 명시적으로 전달받아야 합니다.
*   **인라인 실행 (`${@...}`)**: 변수 값 할당 시 `${@...}` 구문 안에서 호출되어, 함수의 반환값이 해당 변수의 값으로 즉시 할당됩니다.

## 4.5.5 익명 파이썬 함수 (Anonymous Python Functions)

익명 파이썬 함수는 이름 없이 `python () { ... }` 또는 `python { ... }` 형태로 정의되며, 해당 메타데이터 파일의 **파싱이 완료되는 시점에 자동으로 실행**됩니다.

### 4.5.5.1 함수 정의 및 사용법

```bitbake
# 특정 변수(SOME_VAR)의 값에 따라 다른 변수(ANOTHER_VAR)의 값을 동적으로 설정
python () {
    if d.getVar('SOME_VAR') == 'value':
        d.setVar('ANOTHER_VAR', 'new_value')
    else:
        d.appendVar('EXTRA_FEATURES', ' some-feature')
}
```

**주요 특징:**

*   **자동 실행**: 별도의 호출 없이 파싱 과정의 마지막에 자동으로 실행됩니다.
*   **전역적인 `d` 접근**: BitBake 스타일 파이썬 함수처럼 데이터 저장소 객체 `d`에 직접 접근할 수 있습니다.
*   **동적 설정**: 다른 변수의 값이나 특정 조건에 따라 빌드 환경을 동적으로 변경하거나 변수를 설정하는 데 매우 유용합니다. 예를 들어, 특정 머신(`MACHINE`)일 때만 특정 `DISTRO_FEATURES`를 추가하는 등의 로직을 구현할 수 있습니다.
