# 이벤트 (Events)

BitBake는 빌드 프로세스 중에 발생하는 다양한 상황(구성 파싱 완료, 빌드 시작, 태스크 실패 등)을 알리기 위해 이벤트 기반 아키텍처를 사용합니다. 개발자는 이러한 이벤트를 훅(hook)하여 특정 동작을 수행하는 이벤트 핸들러를 작성할 수 있습니다.

## 4.8.1 이벤트 핸들러 (Event Handlers)

이벤트 핸들러는 특정 이벤트가 발생했을 때 실행되는 BitBake 스타일의 파이썬 함수입니다.

### 정의 및 등록 (Definition and Registration)

이벤트 핸들러는 일반적인 파이썬 함수처럼 정의되지만, `addhandler` 지시어를 사용하여 BitBake 이벤트 시스템에 등록해야 합니다.

```bitbake
addhandler my_event_handler
python my_event_handler() {
    from bb.event import getName
    print("The name of the event is %s" % getName(e))
}
```

이벤트 핸들러 함수는 실행 시 암시적으로 `e`라는 변수를 인자로 받습니다. 이 `e`는 발생한 이벤트 객체이며, 이를 통해 이벤트의 종류와 관련 데이터에 접근할 수 있습니다.

### 이벤트 필터링 (Event Filtering)

기본적으로 이벤트 핸들러는 모든 이벤트에 대해 호출됩니다. 성능을 위해 `[eventmask]` 변수 플래그를 사용하여 핸들러가 수신할 이벤트를 제한하는 것이 좋습니다.

```bitbake
addhandler my_build_handler
my_build_handler[eventmask] = "bb.event.BuildStarted bb.event.BuildCompleted"

python my_build_handler() {
    if bb.event.getName(e) == "BuildStarted":
        bb.plain("Build Started")
    elif bb.event.getName(e) == "BuildCompleted":
        bb.plain("Build Completed")
}
```

## 4.8.2 주요 이벤트 유형 (Common Event Types)

BitBake는 다양한 이벤트를 발생시킵니다. 자주 사용되는 이벤트는 다음과 같습니다.

*   **`bb.event.ConfigParsed`**: `local.conf`, `bblayers.conf` 등 기본 구성 파일의 파싱이 완료되었을 때 발생합니다. 변수 값을 확인하거나 수정하기 좋은 시점입니다.
*   **`bb.event.RecipeParsed`**: 각 레시피 파일(`.bb`)이 파싱된 직후에 발생합니다.
*   **`bb.event.BuildStarted`**: 실제 빌드 프로세스(태스크 실행)가 시작될 때 발생합니다.
*   **`bb.event.BuildCompleted`**: 빌드가 성공적으로 완료되거나 실패하여 종료될 때 발생합니다.
*   **`bb.build.TaskStarted`**: 개별 태스크(예: `do_compile`)의 실행이 시작될 때 발생합니다.
*   **`bb.build.TaskSucceeded`**: 태스크가 성공적으로 완료되었을 때 발생합니다.
*   **`bb.build.TaskFailed`**: 태스크 실행이 실패했을 때 발생합니다.

## 4.8.3 활용 예시 (Usage Example)

이벤트 핸들러는 빌드 통계를 수집하거나, 빌드 상태를 외부 시스템에 알리거나, 특정 조건에서 빌드 설정을 동적으로 변경하는 데 유용합니다.

```bitbake
python () {
    if d.getVar('MY_CUSTOM_VAR') == 'yes':
        bb.event.fire(bb.event.ConfigParsed(), d)
}
```
