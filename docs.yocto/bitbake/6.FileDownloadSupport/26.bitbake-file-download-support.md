# 파일 다운로드 지원 (File Download Support)

BitBake의 빌드 프로세스는 필요한 소스 코드를 가져오는 단계인 **Fetch**에서 시작됩니다. BitBake는 다양한 프로토콜과 저장소 유형을 지원하는 강력한 다운로드 엔진을 내장하고 있습니다.

## 6.1 다운로드 (The Download - Fetch)

모든 레시피는 `SRC_URI` 변수를 통해 소스 코드의 위치를 지정합니다. `do_fetch` 태스크는 이 변수를 참조하여 필요한 파일들을 다운로드합니다.

*   **`SRC_URI`**: 소스 파일의 URI 목록을 정의합니다. (예: `git://`, `http://`, `file://`)
*   **`DL_DIR`**: 다운로드된 파일들이 저장되는 중앙 디렉토리입니다. 이 디렉토리는 여러 빌드 간에 공유되어 중복 다운로드를 방지합니다.
*   **체크섬 검증**: HTTP/FTP 등의 프로토콜을 사용할 때, `SRC_URI`에 지정된 체크섬(`sha256sum` 등)과 다운로드된 파일의 체크섬을 비교하여 무결성을 검증합니다.

## 6.2 압축 해제 (The Unpack)

다운로드가 완료되면 `do_unpack` 태스크가 실행되어 소스 코드를 작업 디렉토리(`WORKDIR`) 내의 특정 위치(주로 `S` 변수로 지정된 경로)에 압축 해제하거나 복사합니다.

*   **압축 파일**: `tar.gz`, `zip` 등의 압축 파일은 자동으로 압축이 해제됩니다.
*   **Git/SVN**: 버전 관리 시스템의 경우 체크아웃(Checkout)이 수행됩니다.
*   **일반 파일**: 설정 파일이나 패치 파일 등은 그대로 복사됩니다.

## 6.3 페처 (Fetchers)

BitBake는 URL의 접두사(Scheme)를 보고 적절한 **Fetcher** 모듈을 선택하여 다운로드를 수행합니다.

*   **로컬 파일 (`file://`)**: 레이어 내의 `files/` 디렉토리 등에서 파일을 찾습니다.
*   **HTTP/FTP (`http://`, `https://`, `ftp://`)**: `wget`을 사용하여 파일을 다운로드합니다.
*   **Git (`git://`)**: Git 저장소에서 소스를 클론합니다. `SRCREV` 변수로 특정 커밋 해시나 태그를 지정해야 합니다.
*   **기타**: SVN(`svn://`), CVS(`cvs://`), Mercurial(`hg://`) 등 다양한 SCM을 지원합니다.

## 6.4 자동 리비전 (Auto Revisions)

개발 중인 프로젝트의 경우, 매번 `SRCREV`를 최신 커밋 해시로 업데이트하는 것은 번거로울 수 있습니다. 이럴 때 `AUTOREV`를 사용할 수 있습니다.

```bitbake
SRCREV = "${AUTOREV}"
```

이렇게 설정하면 BitBake는 빌드할 때마다 원격 저장소의 최신 리비전을 확인하여 가져옵니다. (단, 네트워크 연결이 필요하며 재현성이 떨어질 수 있어 릴리스 빌드에서는 권장되지 않습니다.)

## 6.5 다중 소스 저장소 (Multiple Source Control Repositories)

하나의 레시피에서 여러 저장소의 소스 코드가 필요한 경우, `SRC_URI`에 여러 항목을 나열하여 처리할 수 있습니다. 각 항목은 별도의 하위 디렉토리에 배치되도록 `destsuffix` 파라미터를 사용할 수 있습니다.

```bitbake
SRC_URI = "git://repo1.git;name=repo1;destsuffix=repo1 \
           git://repo2.git;name=repo2;destsuffix=repo2"
```
